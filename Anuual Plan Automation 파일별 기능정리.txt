ì£¼ìš” íŒŒì¼ì„ í™•ì¸í•´ ìµœì‹  ìƒíƒœë¥¼ ë°˜ì˜ ì¤‘ì…ë‹ˆë‹¤.


[5 tools called]


ì¶”ê°€ íŒŒì¼ í™•ì¸ ì¤‘ì…ë‹ˆë‹¤.


[3 tools called]


ìµœì‹  ìƒíƒœë¥¼ ë°˜ì˜í•´ ë¬¸ì„œë¥¼ ì—…ë°ì´íŠ¸ ì¤‘ì…ë‹ˆë‹¤.

```markdown:Anuual Plan Automation íŒŒì¼ë³„ ê¸°ëŠ¥ì •ë¦¬.txt
# ğŸ“ í”„ë¡œì íŠ¸ íŒŒì¼ êµ¬ì¡° ë° ì—­í•  ì •ë¦¬ (ìµœì‹  ì—…ë°ì´íŠ¸)

## ğŸ“‚ ë£¨íŠ¸ ë””ë ‰í† ë¦¬

### `package.json`
- í”„ë¡œì íŠ¸ ë©”íƒ€ë°ì´í„° ë° ì˜ì¡´ì„± ê´€ë¦¬
- ì£¼ìš” ì˜ì¡´ì„±:
  - `react`, `react-dom`: React í”„ë ˆì„ì›Œí¬
  - `@supabase/supabase-js`: Supabase í´ë¼ì´ì–¸íŠ¸ (v2.87.0)
  - `date-fns`: ë‚ ì§œ ì²˜ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬
  - `xlsx`: Excel íŒŒì¼ íŒŒì‹±
- ìŠ¤í¬ë¦½íŠ¸: `dev`, `build`, `preview`

### `tsconfig.json`
- TypeScript ì»´íŒŒì¼ëŸ¬ ì„¤ì •
- íƒ€ì… ì²´í¬ ë° ë¹Œë“œ ì˜µì…˜

### `vite.config.ts`
- Vite ë¹Œë“œ ë„êµ¬ ì„¤ì •
- React í”ŒëŸ¬ê·¸ì¸ ì„¤ì •

### `index.html`
- HTML ì§„ì…ì 
- React ì•±ì´ ë§ˆìš´íŠ¸ë˜ëŠ” `#root` ìš”ì†Œ í¬í•¨

### `.env` (í™˜ê²½ ë³€ìˆ˜ íŒŒì¼)
- `VITE_SUPABASE_URL`: Supabase í”„ë¡œì íŠ¸ URL
- `VITE_SUPABASE_ANON_KEY`: Supabase ìµëª… í‚¤

### `PROJECT_RULES.md`
- í”„ë¡œì íŠ¸ ì•„í‚¤í…ì²˜ ì›ì¹™ ì •ì˜
- Domain / Infra / UI 3ê³„ì¸µ êµ¬ì¡° ê·œì¹™
- ë„ë©”ì¸ ë ˆì´ì–´ ê¸ˆì§€ì‚¬í•­ ë° ëª©í‘œ ëª…ì‹œ

---

## ğŸ“‚ `src/` ë””ë ‰í† ë¦¬

### `main.tsx`
- React ì•± ì§„ì…ì 
- `App` ì»´í¬ë„ŒíŠ¸ë¥¼ DOMì— ë Œë”ë§

### `App.tsx`
- ë©”ì¸ ì•± ì»´í¬ë„ŒíŠ¸
- ë‹¨ê³„ë³„ ë¼ìš°íŒ… ê´€ë¦¬:
  - `school` â†’ `year-semester` â†’ `calendar` â†’ `teacher-schedule` / `student-timetable`
- ì „ì—­ ìƒíƒœ ê´€ë¦¬:
  - ì„ íƒëœ í•™êµ (`selectedSchool`)
  - í•™ë…„ë„ (`year`)
  - í•™ê¸° (`semester`)
- ê° ë‹¨ê³„ë³„ ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ ë° ë’¤ë¡œê°€ê¸° ì²˜ë¦¬
- **í•™ìƒ ì‹œê°„í‘œ ì…ë ¥ ë‹¨ê³„ ì¶”ê°€** (`student-timetable`)

### `App.css`
- ì•± ì „ì²´ ìŠ¤íƒ€ì¼

### `index.css`
- ì „ì—­ CSS ë¦¬ì…‹ ë° ê¸°ë³¸ ìŠ¤íƒ€ì¼

### `types.ts`
- TypeScript íƒ€ì… ì •ì˜
- ì£¼ìš” ì¸í„°í˜ì´ìŠ¤:
  - `School`: í•™êµ ì •ë³´ (`id`, `name`)
  - `AcademicCalendar`: í•™ì‚¬ì¼ì • (í•™êµ, ì—°ë„, í•™ê¸°, ì´ë²¤íŠ¸ ëª©ë¡)
  - `SavedCalendar`: ì €ì¥ëœ í•™ì‚¬ì¼ì • (`savedAt` íƒ€ì„ìŠ¤íƒ¬í”„ í¬í•¨)
  - `CalendarEvent`: ë‹¬ë ¥ ì´ë²¤íŠ¸
    - íƒ€ì…: `holiday`, `midterm`, `final`, `recess`, `custom`, `direct`, `substitute`, `opening`, `closing`, `mocktest`
    - ì†ì„±: `id`, `date`, `type`, `name`, `grades` (ì ìš© í•™ë…„ ë°°ì—´)
  - `ClassSchedule`: êµì‚¬ ì‹œê°„í‘œ (Excel íŒŒì‹± ë°ì´í„°)
    - ì†ì„±: `id`, `teacherId`, `teacherName`, `subject`, `grade`, `classNumber`, `dayOfWeek`, `period`
    - Supabase ë©”íƒ€ë°ì´í„°: `schoolId?`, `year?`, `semester?`
  - `ClassSession`: ìˆ˜ì—… íšŒì°¨ ì •ë³´ (ìƒì„±ëœ ìˆ˜ì—… ì¼ì •)
    - ì†ì„±: `sessionNumber`, `date`, `dayOfWeek`, `period`, `classInfo`, `academicEvent`, `content`, `isBeforeFirstTest`
    - **`segment`**: ì‹œí—˜ êµ¬ê°„ êµ¬ë¶„ (`ExamSegment` íƒ€ì…, ì˜µì…˜)
      - `'before_first'`: 1ì°¨ ì§€í•„ ì „
      - `'between_first_second'`: 1ì°¨~2ì°¨ ì§€í•„ ì‚¬ì´
      - `'after_second'`: 2ì°¨ ì§€í•„ ì´í›„
    - Supabase ë©”íƒ€ë°ì´í„°: `id?`, `schoolId?`, `year?`, `semester?`, `teacherId?`, `teacherName?`, `grade?`, `classNumber?`, `subject?`
  - `ParsedSchedule`: íŒŒì‹±ëœ ì‹œê°„í‘œ ì „ì²´ êµ¬ì¡°
  - `ExamSegment`: ì‹œí—˜ êµ¬ê°„ íƒ€ì… (`'before_first' | 'between_first_second' | 'after_second'`)
  - `LessonPlanTemplate`: ìˆ˜ì—… ê³„íš í…œí”Œë¦¿ íƒ€ì…
    - ì†ì„±: `id?`, `schoolId`, `year`, `semester`, `teacherId`, `grade`, `subject`, `segment`, `sessionIndex`, `content`
  - **`StudentBaseTimetableRow`**: í•™ìƒ ì‹œê°„í‘œ í–‰ ë°ì´í„° íƒ€ì…
    - ì†ì„±: `schoolId`, `year`, `semester`, `grade`, `classNumber`, `studentNumber`, `studentName`, `dayOfWeek`, `period`, `subject`, `teacherId?`, `teacherName?`, `room?`
    - Supabase `student_timetables` í…Œì´ë¸”ê³¼ 1:1 ë§¤í•‘ìš©

### `vite-env.d.ts`
- Vite íƒ€ì… ì •ì˜ íŒŒì¼

---

## ğŸ“‚ `src/core/domain/` ë””ë ‰í† ë¦¬ (Domain Layer)

### `sessions.ts`
- ì—­í• : ìˆœìˆ˜ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ (ë„ë©”ì¸ ë ˆì´ì–´)
- í˜„ì¬ ìƒíƒœ: ê³µí†µ ìˆ˜ì—… ê³„íš ê´€ë ¨ í•¨ìˆ˜ë“¤ì´ êµ¬í˜„ë¨
- ì •ì˜ëœ íƒ€ì…:
  - `GenerateSessionsParams`: ìˆ˜ì—… ì„¸ì…˜ ìƒì„± íŒŒë¼ë¯¸í„° íƒ€ì… (TODO ìƒíƒœ)
  - `CommonPlanAnalysis`: ê³µí†µ ê³„íš ë¶„ì„ ê²°ê³¼ íƒ€ì…
    - `canUseCommonPlan`: ê³µí†µ ê³„íš ì‚¬ìš© ê°€ëŠ¥ ì—¬ë¶€
    - `minCount`: ìµœì†Œ íšŒì°¨ ìˆ˜
    - `classNumbers`: í¬í•¨ëœ ë°˜ ë²ˆí˜¸ ëª©ë¡
  - `LessonPlanTemplateRow`: í…œí”Œë¦¿ í•œ ì¤„ íƒ€ì… (`segment`, `sessionIndex`, `content`)
- ì •ì˜ëœ í•¨ìˆ˜:
  - `generateClassSessions()`: í˜„ì¬ ë¹ˆ êµ¬í˜„ (TODO ì£¼ì„ í¬í•¨, í–¥í›„ êµ¬í˜„ ì˜ˆì •)
  - `analyzeCommonPlanForSegment()`: ì„¸ê·¸ë¨¼íŠ¸ë³„ ê³µí†µ ê³„íš ë¶„ì„
    - ì—¬ëŸ¬ ë°˜ì˜ ì„¸ì…˜ì„ ë¶„ì„í•˜ì—¬ ìµœì†Œ íšŒì°¨ ê³„ì‚°
    - ë°˜ì´ 2ê°œ ì´ìƒì¸ ê²½ìš°ì—ë§Œ ê³µí†µ ê³„íš ì‚¬ìš© ê°€ëŠ¥
    - `segment` í•„ë“œë¥¼ ìš°ì„  ì‚¬ìš©, ì—†ìœ¼ë©´ ê¸°ì¡´ í”Œë˜ê·¸ ê¸°ë°˜ ë¡œì§ ì‚¬ìš©
  - `applyTemplateToSessions()`: í…œí”Œë¦¿ì„ ì‹¤ì œ ì„¸ì…˜ì— ì ìš©
    - ì„¸ê·¸ë¨¼íŠ¸ë³„ë¡œ í…œí”Œë¦¿ ë‚´ìš©ì„ ì„¸ì…˜ì˜ `content`ì— ì ìš©
    - ìµœì†Œ íšŒì°¨ ì´í›„ íšŒì°¨ì— ëŒ€í•´ `extraSessionsContent` ì ìš© ê°€ëŠ¥
  - `computeMinSessionsBySegment()`: ì„¸ê·¸ë¨¼íŠ¸ë³„ ìµœì†Œ íšŒì°¨ ê³„ì‚° (í¸ì˜ í•¨ìˆ˜)
  - `isSessionInSegment()`: ì„¸ì…˜ì´ íŠ¹ì • ì„¸ê·¸ë¨¼íŠ¸ì— ì†í•˜ëŠ”ì§€ íŒë‹¨ (ë‚´ë¶€ í—¬í¼)
    - `segment` í•„ë“œ ìš°ì„  ì‚¬ìš©, ì—†ìœ¼ë©´ `isBeforeFirstTest` ë“± ê¸°ì¡´ í”Œë˜ê·¸ ì‚¬ìš©
- ëª©í‘œ:
  - í•™ê¸° ê¸°ê°„ ê³„ì‚° ë¡œì§
  - í•™ì‚¬ì¼ì • ì´ë²¤íŠ¸ ì²˜ë¦¬
  - ì‹œê°„í‘œ + í•™ì‚¬ì¼ì • â†’ ìˆ˜ì—… íšŒì°¨ ìƒì„± ë¡œì§
  - 1ì°¨/2ì°¨ ì§€í•„ ì „Â·í›„ êµ¬ê°„ë³„ íšŒì°¨ ë²ˆí˜¸ ì¹´ìš´íŒ…
  - ê³µí†µ ìˆ˜ì—… ê³„íš í…œí”Œë¦¿ ë¶„ì„ ë° ì ìš©
- ê¸ˆì§€ì‚¬í•­:
  - React, Supabase, XLSX ë“± í”„ë ˆì„ì›Œí¬/ë¼ì´ë¸ŒëŸ¬ë¦¬ ì˜ì¡´ ê¸ˆì§€
  - API í˜¸ì¶œ, DB ì¿¼ë¦¬, íŒŒì¼ I/O ê¸ˆì§€
- ëª©í‘œ: ìˆœìˆ˜ í•¨ìˆ˜ ì¤‘ì‹¬, Node í™˜ê²½ì—ì„œ unit testë§Œìœ¼ë¡œ ê²€ì¦ ê°€ëŠ¥
- ì°¸ê³ : í˜„ì¬ëŠ” `src/utils/scheduleMatcher.ts`ì— ì‹¤ì œ ìˆ˜ì—… ì„¸ì…˜ ìƒì„± ë¡œì§ì´ êµ¬í˜„ë˜ì–´ ìˆìŒ (í–¥í›„ ì´ê³³ìœ¼ë¡œ ì´ë™ ì˜ˆì •)

---

## ğŸ“‚ `src/infra/` ë””ë ‰í† ë¦¬ (Infrastructure Layer)

### `src/infra/supabase/` ë””ë ‰í† ë¦¬

#### `client.ts`
- ì—­í• : Supabase í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™”
- ê¸°ëŠ¥:
  - í™˜ê²½ ë³€ìˆ˜ì—ì„œ `VITE_SUPABASE_URL`, `VITE_SUPABASE_ANON_KEY` ë¡œë“œ
  - Supabase í´ë¼ì´ì–¸íŠ¸ ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ë° export
  - í™˜ê²½ ë³€ìˆ˜ ëˆ„ë½ ì‹œ ì—ëŸ¬ throw
- Export: `supabase` í´ë¼ì´ì–¸íŠ¸ ì¸ìŠ¤í„´ìŠ¤

#### `storage.ts`
- ì—­í• : Supabase ë°ì´í„° ì €ì¥/ë¡œë“œ ìœ í‹¸ë¦¬í‹°
- ì±…ì„: DB ì»¬ëŸ¼ëª…(`school_id`, `class_number` ë“±)ê³¼ ë„ë©”ì¸ íƒ€ì… í•„ë“œ(`schoolId`, `classNumber` ë“±) ë§¤í•‘
- í•™êµ ê´€ë ¨:
  - `getSchools()`: Supabaseì—ì„œ í•™êµ ëª©ë¡ ì¡°íšŒ (ì´ë¦„ìˆœ ì •ë ¬)
  - `searchSchoolsByName(keyword)`: í•™êµ ì´ë¦„ ë¶€ë¶„ ì¼ì¹˜ ê²€ìƒ‰ (ëŒ€ì†Œë¬¸ì ë¬´ì‹œ, ìµœëŒ€ 10ê°œ)
  - `saveSchool()`: í•™êµ ì €ì¥ (upsert, `onConflict: 'id'`)
- í•™ì‚¬ì¼ì • ê´€ë ¨:
  - `getCalendars()`: ì €ì¥ëœ í•™ì‚¬ì¼ì • ëª©ë¡ ì¡°íšŒ
  - `saveCalendar()`: í•™ì‚¬ì¼ì • ì €ì¥ (upsert, `onConflict: 'school_id,year,semester'`)
  - `getCalendarById()`: íŠ¹ì • í•™ì‚¬ì¼ì • ì¡°íšŒ
  - `getCalendarsBySchool()`: í•™êµë³„ í•™ì‚¬ì¼ì • ì¡°íšŒ
  - `getCalendarFor()`: íŠ¹ì • í•™êµ/ì—°ë„/í•™ê¸°ì˜ í•™ì‚¬ì¼ì • ì¡°íšŒ
- êµì‚¬ ì‹œê°„í‘œ ê´€ë ¨:
  - `saveTeacherSchedules()`: Excel íŒŒì‹± ë°ì´í„°ë¥¼ Supabaseì— ì €ì¥
    - ê¸°ì¡´ ë°ì´í„° ì‚­ì œ í›„ ìƒˆ ë°ì´í„° ì‚½ì…
    - í…Œì´ë¸”: `teacher_schedules`
  - `getTeacherSchedules()`: íŠ¹ì • í•™êµ/ì—°ë„/í•™ê¸°ì˜ ì‹œê°„í‘œ ì¡°íšŒ
- ìˆ˜ì—… ì„¸ì…˜ ê´€ë ¨:
  - `saveClassSessions()`: ìƒì„±ëœ ìˆ˜ì—… ì¼ì •ì„ Supabaseì— ì €ì¥
    - ê¸°ì¡´ ë°ì´í„° ì‚­ì œ í›„ ìƒˆ ë°ì´í„° ì‚½ì…
    - í…Œì´ë¸”: `class_sessions`
    - **`segment` í•„ë“œ ì €ì¥ ì§€ì›** (null í—ˆìš©)
  - `getClassSessions()`: íŠ¹ì • êµì‚¬/í•™ë…„/ë°˜/ê³¼ëª©ì˜ ìˆ˜ì—… ì„¸ì…˜ ì¡°íšŒ
    - **ê³¼ëª©(`subject`) íŒŒë¼ë¯¸í„° ì¶”ê°€**
  - `getClassSessionsByTeacherGradeSubject()`: êµì‚¬/í•™ë…„/ê³¼ëª©ë³„ ëª¨ë“  ë°˜ì˜ ì„¸ì…˜ ì¡°íšŒ
    - **`segment` í•„ë“œ ë§¤í•‘ í¬í•¨** (ì—†ìœ¼ë©´ undefined)
- ìˆ˜ì—… ê³„íš í…œí”Œë¦¿ ê´€ë ¨:
  - `getLessonPlanTemplates()`: íŠ¹ì • êµì‚¬/í•™ë…„/ê³¼ëª©/êµ¬ê°„ì˜ í…œí”Œë¦¿ ì¡°íšŒ
  - `saveLessonPlanTemplates()`: í…œí”Œë¦¿ ì €ì¥ (upsert, `onConflict: 'school_id,year,semester,teacher_id,grade,subject,segment,session_index'`)
    - ë¹ˆ ë°°ì—´ ì „ë‹¬ ì‹œ ê¸°ì¡´ í…œí”Œë¦¿ ì‚­ì œ
- **í•™ìƒ ì‹œê°„í‘œ ê´€ë ¨**:
  - `saveStudentTimetables()`: í•™ìƒ ì‹œê°„í‘œ ë°ì´í„°ë¥¼ Supabaseì— ì €ì¥
    - ê¸°ì¡´ ë°ì´í„° ì‚­ì œ í›„ ìƒˆ ë°ì´í„° ì‚½ì…
    - í…Œì´ë¸”: `student_timetables`
    - ì—¬ëŸ¬ íŒŒì¼ì—ì„œ íŒŒì‹±ëœ ë°ì´í„°ë¥¼ ì¼ê´„ ì €ì¥ ê°€ëŠ¥
  - `getStudentTimetableByStudentCode()`: í•™ë²ˆìœ¼ë¡œ í•™ìƒ ì‹œê°„í‘œ ì¡°íšŒ
    - í•™ë²ˆì„ 5ìë¦¬ë¡œ ë³´ì • (ì˜ˆ: "601" â†’ "00601")
    - `student_code` generated column ì‚¬ìš©
    - ìš”ì¼/êµì‹œ ìˆœìœ¼ë¡œ ì •ë ¬í•˜ì—¬ ë°˜í™˜
- íŠ¹ì§•:
  - React ê´€ë ¨ ì½”ë“œ ì—†ìŒ
  - ë°ì´í„° I/Oë§Œ ë‹´ë‹¹
  - DB ì»¬ëŸ¼ëª…ê³¼ ë„ë©”ì¸ íƒ€ì… ê°„ ë³€í™˜ ì²˜ë¦¬

#### `sessionProcessor.ts`
- ì—­í• : ìˆ˜ì—… ì„¸ì…˜ ì¼ê´„ ì²˜ë¦¬ ë° í…œí”Œë¦¿ ì ìš©
- ê¸°ëŠ¥:
  - `processAllClassSessions()`: í•œ í•™êµ/í•™ë…„ë„/í•™ê¸°ì˜ ëª¨ë“  êµì‚¬Â·í•™ê¸‰ì— ëŒ€í•´ ìˆ˜ì—… ì„¸ì…˜ ìë™ ìƒì„±
    - `teacher_schedules`ì™€ `calendars`ë¥¼ ì¡°í•©í•˜ì—¬ `class_sessions` ìƒì„±
    - êµì‚¬/í•™ë…„/ë°˜ë³„ë¡œ ê·¸ë£¹í•‘í•˜ì—¬ ì¼ê´„ ì²˜ë¦¬
    - ìƒì„±ëœ ì„¸ì…˜ ì´ ê°œìˆ˜ ë°˜í™˜
  - `applyLessonTemplateToClassSessions()`: ê³µí†µ ìˆ˜ì—… ê³„íš í…œí”Œë¦¿ì„ ì‹¤ì œ ì„¸ì…˜ì— ì ìš©
    - íŠ¹ì • êµì‚¬/í•™ë…„/ê³¼ëª©/êµ¬ê°„ì˜ ëª¨ë“  ë°˜ ì„¸ì…˜ ì¡°íšŒ
    - ë„ë©”ì¸ í•¨ìˆ˜(`analyzeCommonPlanForSegment`, `applyTemplateToSessions`) í˜¸ì¶œ
    - ë°˜ë³„ë¡œ ê·¸ë£¹í•‘í•˜ì—¬ ì €ì¥
- Import:
  - `storage` from `./storage`
  - `generateClassSessions` from `../../utils/scheduleMatcher`
  - ë„ë©”ì¸ í•¨ìˆ˜ë“¤ from `../../core/domain/sessions`

### `src/infra/excel/` ë””ë ‰í† ë¦¬

#### `excelParser.ts`
- ì—­í• : Excel íŒŒì¼ íŒŒì‹± (ë‚˜ì´ìŠ¤ ì‹œìŠ¤í…œ ì‹œê°„í‘œ)
- ê¸°ëŠ¥:
  - `parseExcelFile(file)`: Excel íŒŒì¼ì„ ì½ì–´ì„œ `ClassSchedule[]` ë°˜í™˜
    - `FileReader` API ì‚¬ìš©
    - XLSX ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ íŒŒì¼ ì½ê¸°
    - ì²« ë²ˆì§¸ ì‹œíŠ¸ ì‚¬ìš©
  - `parseCellContent(cellValue)`: ì…€ ë‚´ìš© íŒŒì‹±
    - ì˜ˆ: "3í•™ë…„ ë¯¸ìˆ  ì°½ì‘(3)" â†’ `{ grade: 3, subject: "ë¯¸ìˆ  ì°½ì‘", classNumber: 3 }`
  - `parseTeacherName(teacherCell)`: êµì‚¬ ì´ë¦„ íŒŒì‹±
    - ì˜ˆ: "yeayeah03(ê³ ì˜ˆì§„)" â†’ `{ id: "yeayeah03", name: "ê³ ì˜ˆì§„" }`
    - ê´„í˜¸ê°€ ì—†ëŠ” ê²½ìš°: ì…ë ¥ê°’ì„ ê·¸ëŒ€ë¡œ idì™€ nameìœ¼ë¡œ ì‚¬ìš©
  - í—¤ë” í–‰ ìë™ ê°ì§€ (ìˆœë²ˆ, êµì‚¬ì„±ëª…)
  - ìš”ì¼ í—¤ë” ë§¤í•‘ (ì›”, í™”, ìˆ˜, ëª©, ê¸ˆ, í† , ì¼)
  - êµì‹œë³„ ë°ì´í„° ì¶”ì¶œ (1-7êµì‹œ)
  - í—¤ë” í–‰ì—ì„œ ìš”ì¼ì„ ì°¾ì§€ ëª»í•œ ê²½ìš° ë‹¤ìŒ í–‰ë„ í™•ì¸
  - ë‘ ì¤„ë¡œ ë‚˜ë‰œ í–‰ ë³‘í•© ì²˜ë¦¬ (`mergeTwoRows` í•¨ìˆ˜)
    - êµì‚¬ ì´ë¦„ì´ ë‘ ì¤„ë¡œ ë‚˜ë‰œ ê²½ìš° ë³‘í•©
    - ê³¼ëª©ëª…ì´ ë‘ ì¤„ë¡œ ë‚˜ë‰œ ê²½ìš° ë³‘í•©
- ì‚¬ìš© ë¼ì´ë¸ŒëŸ¬ë¦¬: `xlsx`
- Export: `parseExcelFile`, `parseCellContent`, `parseTeacherName`

#### `studentTimetableParser.ts`
- ì—­í• : í•™ìƒë³„ ìˆ˜ì—…ì‹œê°„í‘œ Excel íŒŒì¼ íŒŒì‹± (ë‚˜ì´ìŠ¤ ì‹œìŠ¤í…œ)
- ê¸°ëŠ¥:
  - `parseStudentTimetable(file, options)`: Excel íŒŒì¼ì„ ì½ì–´ì„œ `StudentBaseTimetableRow[]` ë°˜í™˜
    - `FileReader` API ì‚¬ìš©
    - XLSX ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ íŒŒì¼ ì½ê¸°
    - ì²« ë²ˆì§¸ ì‹œíŠ¸ ì‚¬ìš©
  - íŒŒì¼ í¬ë§· ì²˜ë¦¬:
    - í—¤ë”: "2025í•™ë…„ë„ 2í•™ê¸° 3í•™ë…„ 6ë°˜ 1ë²ˆ ê°•ì¤€ì˜" í˜•ì‹
    - ìš”ì¼ í—¤ë”: 'êµ  ì‹œ / ì›”ìš”ì¼ / ... / ê¸ˆìš”ì¼'
    - ê° êµì‹œëŠ” 2ì¤„ êµ¬ì¡°:
      - ì²« ì¤„: êµì‹œ ë²ˆí˜¸ + ê° ìš”ì¼ì˜ ë°˜ ì •ë³´
      - ë‘ ë²ˆì§¸ ì¤„: ê° ìš”ì¼ì˜ ê³¼ëª©(êµì‚¬ëª…)
  - í•™ìƒ ì •ë³´ ì¶”ì¶œ (í•™ë…„, ë°˜, ë²ˆí˜¸, ì´ë¦„)
  - ìš”ì¼ë³„/êµì‹œë³„ ê³¼ëª© ë° êµì‚¬ ì •ë³´ ì¶”ì¶œ
  - êµì‚¬ëª… íŒŒì‹± (ê´„í˜¸ ì²˜ë¦¬)
  - êµì‹¤ ì •ë³´ ì¶”ì¶œ (ìˆëŠ” ê²½ìš°)
- ì‚¬ìš© ë¼ì´ë¸ŒëŸ¬ë¦¬: `xlsx`
- Export: `parseStudentTimetable`

---

## ğŸ“‚ `src/ui/` ë””ë ‰í† ë¦¬ (UI Layer)

- í˜„ì¬ ìƒíƒœ: í´ë” ìƒì„±ë¨ (ë¹„ì–´ìˆìŒ)
- ëª©í‘œ: UI ì»´í¬ë„ŒíŠ¸ë¥¼ ì´ê³³ìœ¼ë¡œ ì´ë™ ì˜ˆì •
- í˜„ì¬ëŠ” `src/components/`ì— ìœ„ì¹˜

---

## ğŸ“‚ `src/components/` ë””ë ‰í† ë¦¬ (í˜„ì¬ UI ì»´í¬ë„ŒíŠ¸ ìœ„ì¹˜)

### `SchoolSelection.tsx` / `SchoolSelection.css`
- ì—­í• : í•™êµ ì„ íƒ/ë“±ë¡ í™”ë©´
- ê¸°ëŠ¥:
  - í•™êµ ì´ë¦„ ì…ë ¥ (ìë™ì™„ì„± ìŠ¤íƒ€ì¼)
  - ë¶€ë¶„ ì¼ì¹˜ ê²€ìƒ‰ìœ¼ë¡œ ì¶”ì²œ ë¦¬ìŠ¤íŠ¸ í‘œì‹œ (ë„¤ì´ë²„ ì—°ê´€ê²€ìƒ‰ì–´ ìŠ¤íƒ€ì¼)
  - ì¶”ì²œ ë¦¬ìŠ¤íŠ¸ì—ì„œ í´ë¦­í•˜ì—¬ ë°”ë¡œ ì„ íƒ ê°€ëŠ¥
  - ê¸°ì¡´ í•™êµ ì •í™•í•œ ì¼ì¹˜ ì‹œ í™•ì¸ ë°•ìŠ¤ í‘œì‹œ
  - ìƒˆ í•™êµ ë“±ë¡
  - Supabaseì—ì„œ í•™êµ ëª©ë¡ ì¡°íšŒ ë° ê²€ìƒ‰
  - **í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜ ì§€ì›**:
    - `ArrowDown`: ì¶”ì²œ ë¦¬ìŠ¤íŠ¸ ì•„ë˜ë¡œ ì´ë™
    - `ArrowUp`: ì¶”ì²œ ë¦¬ìŠ¤íŠ¸ ìœ„ë¡œ ì´ë™
    - `Enter`: í•˜ì´ë¼ì´íŠ¸ëœ í•™êµ ì„ íƒ ë˜ëŠ” ì •í™•íˆ ì¼ì¹˜í•˜ëŠ” í•™êµ í™•ì¸
  - **ê²€ìƒ‰ ì¤‘ ìƒíƒœ ê´€ë¦¬** (`isSearching`): ê²€ìƒ‰ ì¤‘ì—ëŠ” Enter í‚¤ ì…ë ¥ ë°©ì§€
  - **ì¶”ì²œ ë¦¬ìŠ¤íŠ¸ì— "ìƒˆ í•™êµ ë“±ë¡" ì˜µì…˜ í‘œì‹œ**: ì •í™•íˆ ì¼ì¹˜í•˜ëŠ” í•™êµê°€ ì—†ì„ ë•Œë§Œ í‘œì‹œ
- Props: `onSelect: (school: School) => void`
- Import: `storage` from `../infra/supabase/storage`
- ì£¼ìš” ìƒíƒœ:
  - `suggestions`: ê²€ìƒ‰ ì¶”ì²œ ë¦¬ìŠ¤íŠ¸
  - `foundSchool`: ì •í™•íˆ ì¼ì¹˜í•˜ëŠ” í•™êµ
  - `hasSelected`: ì„ íƒ ì™„ë£Œ ì—¬ë¶€
  - `highlightedIndex`: í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜ í•˜ì´ë¼ì´íŠ¸ ì¸ë±ìŠ¤
  - `isSearching`: ê²€ìƒ‰ ì§„í–‰ ì¤‘ ì—¬ë¶€

### `YearSemesterSelection.tsx` / `YearSemesterSelection.css`
- ì—­í• : í•™ë…„ë„ ë° í•™ê¸° ì„ íƒ í™”ë©´
- ê¸°ëŠ¥:
  - ë“œë¡­ë‹¤ìš´ìœ¼ë¡œ í•™ë…„ë„ ì„ íƒ (í˜„ì¬ë…„ë„ Â±5ë…„)
  - 1í•™ê¸°/2í•™ê¸° ì„ íƒ ë²„íŠ¼
  - ë’¤ë¡œê°€ê¸° ë²„íŠ¼
- Props: `onConfirm: (year, semester) => void`, `onBack: () => void`

### `CalendarEditor.tsx` / `CalendarEditor.css`
- ì—­í• : í•™ì‚¬ì¼ì • ë‹¬ë ¥ í¸ì§‘ í™”ë©´
- ê¸°ëŠ¥:
  - ì›”ë³„ ë‹¬ë ¥ ë Œë”ë§ (í•™ê¸° ê¸°ê°„ì— ë§ì¶°)
  - ë‚ ì§œ í´ë¦­ìœ¼ë¡œ ì´ë²¤íŠ¸ ì¶”ê°€/ìˆ˜ì • (ëª¨ë‹¬ ë°©ì‹)
  - ì´ë²¤íŠ¸ ìœ í˜•:
    - `holiday`: ê³µíœ´ì¼
    - `midterm`: 1ì°¨ ì§€í•„
    - `final`: 2ì°¨ ì§€í•„
    - `mocktest`: ëª¨ì˜ê³ ì‚¬
    - `recess`: ì¬ëŸ‰íœ´ì—…ì¼
    - `substitute`: ëŒ€ì²´ê³µíœ´ì¼
    - `opening`: ê°œí•™ì‹
    - `closing`: ë°©í•™ì‹
    - `direct`: ì§ì ‘ ì…ë ¥
    - `custom`: ì¼ë°˜ ì¼ì •
  - ê¸°ê°„ ì„¤ì • (ì‹œì‘ì¼~ì¢…ë£Œì¼, ì£¼ë§ ìë™ ì œì™¸)
  - í•™ë…„ë³„ í•„í„°ë§ (1, 2, 3í•™ë…„, ì „ì²´) - ë‹¬ë ¥ í‘œì‹œ í•„í„°
  - í•™ë…„ë³„ ì´ë²¤íŠ¸ ì ìš© ë²”ìœ„ ì„¤ì • (`grades` ë°°ì—´)
  - ì´ë²¤íŠ¸ ë°°ì§€ í‘œì‹œ (ìµœëŒ€ 5ê°œ, ìƒ‰ìƒ êµ¬ë¶„)
  - ì €ì¥ ê¸°ëŠ¥ (Supabase)
  - ë§ˆì§€ë§‰ ì €ì¥ ì‹œê°„ í‘œì‹œ
  - ë³€ê²½ ì‚¬í•­ ê°ì§€ (`isModified` ìƒíƒœ)
  - ì €ì¥ í™•ì¸ ë²„íŠ¼ (ë””ë²„ê¹…ìš©, Supabase ìƒíƒœ í™•ì¸)
  - ë‹¤ìŒ ë‹¨ê³„ë¡œ ì´ë™ ë²„íŠ¼ (ì €ì¥ ì™„ë£Œ í›„ì—ë§Œ í‘œì‹œ)
    - **"ë‹¤ìŒ: êµì‚¬ ì‹œê°„í‘œ ì…ë ¥ â†’"** ë²„íŠ¼ (`onNext`)
    - **"ë‹¤ìŒ: í•™ìƒ ì‹œê°„í‘œ ì…ë ¥ â†’"** ë²„íŠ¼ (`onNextStudentTimetable`)
  - 2í•™ê¸° ì„ íƒ ì‹œ 1í•™ê¸° 8ì›” ë°ì´í„° ìë™ ë¡œë“œ
  - ê³µíœ´ì¼ ìë™ ì¶”ê°€ (í•™ê¸° ê¸°ê°„ ë‚´)
- Props: `school`, `year`, `semester`, `onBack`, `onNext?`, `onNextStudentTimetable?`
- Import:
  - `storage` from `../infra/supabase/storage`
  - `holidays` utilities from `../utils/holidays`
- ì£¼ìš” ìƒíƒœ:
  - `events`: í•™ì‚¬ì¼ì • ì´ë²¤íŠ¸ ë°°ì—´
  - `savedAt`: ë§ˆì§€ë§‰ ì €ì¥ ì‹œê°„
  - `isModified`: ë³€ê²½ ì‚¬í•­ ì—¬ë¶€
  - `gradeFilter`: ë‹¬ë ¥ í‘œì‹œ í•„í„° (ì „ì²´/1í•™ë…„/2í•™ë…„/3í•™ë…„)

### `TeacherScheduleUpload.tsx` / `TeacherScheduleUpload.css`
- ì—­í• : êµì‚¬ ì‹œê°„í‘œ Excel íŒŒì¼ ì—…ë¡œë“œ ë° ìˆ˜ì—… ì¼ì • ìƒì„±
- ê¸°ëŠ¥:
  - Excel íŒŒì¼ ì—…ë¡œë“œ (ë‚˜ì´ìŠ¤ ì‹œìŠ¤í…œ ì•ˆë‚´ í¬í•¨)
  - íŒŒì¼ íŒŒì‹± (`excelParser.ts` í˜¸ì¶œ)
  - íŒŒì‹±ëœ ë°ì´í„°ë¥¼ Supabaseì— ì €ì¥ (`storage.saveTeacherSchedules()`)
  - ê¸°ì¡´ ì €ì¥ëœ ì‹œê°„í‘œ ìë™ ë¡œë“œ (ì»´í¬ë„ŒíŠ¸ ë§ˆìš´íŠ¸ ì‹œ)
  - êµì‚¬ ê²€ìƒ‰ ê¸°ëŠ¥ (ì´ë¦„ ë˜ëŠ” ì•„ì´ë””ë¡œ ê²€ìƒ‰, ì¶”ì²œ ë¦¬ìŠ¤íŠ¸ í‘œì‹œ)
  - **í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜ (â†‘, â†“, Enter) ì§€ì›**:
    - `ArrowDown`: ì¶”ì²œ ë¦¬ìŠ¤íŠ¸ ì•„ë˜ë¡œ ì´ë™
    - `ArrowUp`: ì¶”ì²œ ë¦¬ìŠ¤íŠ¸ ìœ„ë¡œ ì´ë™
    - `Enter`: í•˜ì´ë¼ì´íŠ¸ëœ êµì‚¬ ì„ íƒ
  - êµì‚¬ ì„ íƒ í›„ ë¶„ê¸°:
    - `plan` ëª¨ë“œ: í•™ê¸‰ë³„ ì§„ë„ ê³„íší‘œ ìƒì„± (í•™ë…„/ê³¼ëª©/ë°˜ ì„ íƒ â†’ ìˆ˜ì—… ì¼ì • ìƒì„±)
    - `timetable` ëª¨ë“œ: êµì‚¬ ì‹œê°„í‘œ í‘œì‹œ (ìš”ì¼/êµì‹œë³„ ì‹œê°„í‘œ í…Œì´ë¸”)
  - êµì‚¬/í•™ë…„/ê³¼ëª©/ë°˜ ì„ íƒ ë“œë¡­ë‹¤ìš´
  - ìˆ˜ì—… ì¼ì • ìƒì„± ë²„íŠ¼ (`scheduleMatcher.ts` í˜¸ì¶œ)
  - **DBì—ì„œ ìˆ˜ì—… ì¼ì • ìë™ ë¡œë“œ** (`loadSessionsFromDB`):
    - `viewMode`ê°€ `'plan'`ì´ê³  êµì‚¬/í•™ë…„/ê³¼ëª©/ë°˜ì´ ëª¨ë‘ ì„ íƒë˜ë©´ ìë™ìœ¼ë¡œ DBì—ì„œ ì„¸ì…˜ ë¡œë“œ
    - DBì— ì—†ìœ¼ë©´ ê¸°ì¡´ ë°©ì‹ëŒ€ë¡œ í”„ë¡ íŠ¸ì—ì„œ ìƒì„± (fallback)
  - ìƒì„±ëœ ì¼ì •ì„ Supabaseì— ì €ì¥ (`storage.saveClassSessions()`)
  - ìƒì„±ëœ ì¼ì •ì„ `ClassSessionTable`ë¡œ ì „ë‹¬
  - ì „ì²´ ì €ì¥ ë²„íŠ¼ (ìˆ˜ì—… ì¼ì •ì„ Supabaseì— ì €ì¥)
  - ì „ì²´ ìë™ ìƒì„± ë²„íŠ¼ (`processAllClassSessions` í˜¸ì¶œ)
  - ê³µí†µ ìˆ˜ì—… ê³„íš í…œí”Œë¦¿ í¸ì§‘ê¸° ì—´ê¸° (`LessonPlanTemplateEditor`)
- Props: `school`, `year`, `semester`, `onBack`
- Import:
  - `parseExcelFile` from `../infra/excel/excelParser`
  - `storage` from `../infra/supabase/storage`
  - `generateClassSessions` from `../utils/scheduleMatcher`
  - `processAllClassSessions` from `../infra/supabase/sessionProcessor`
  - `ClassSessionTable` from `./ClassSessionTable`
  - `LessonPlanTemplateEditor` from `./LessonPlanTemplateEditor`
- ì£¼ìš” ìƒíƒœ:
  - `teacherSearchTerm`: êµì‚¬ ê²€ìƒ‰ì–´
  - `filteredTeacherOptions`: ê²€ìƒ‰ì–´ë¡œ í•„í„°ë§ëœ êµì‚¬ ë¦¬ìŠ¤íŠ¸
  - `highlightedIndex`: í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜ í•˜ì´ë¼ì´íŠ¸ ì¸ë±ìŠ¤
  - `viewMode`: 'plan' | 'timetable' | null
  - `schedules`: íŒŒì‹±ëœ ì‹œê°„í‘œ ë°ì´í„°
  - `sessions`: ìƒì„±ëœ ìˆ˜ì—… ì„¸ì…˜
  - `isPlanEditorOpen`: ê³µí†µ ìˆ˜ì—… ê³„íš í¸ì§‘ê¸° ì—´ë¦¼ ì—¬ë¶€
  - `selectedSubject`: ì„ íƒëœ ê³¼ëª©

### `StudentTimetableUpload.tsx` / `StudentTimetableUpload.css`
- ì—­í• : í•™ìƒ ì‹œê°„í‘œ Excel íŒŒì¼ ì—…ë¡œë“œ í™”ë©´
- ê¸°ëŠ¥:
  - ë‚˜ì´ìŠ¤ ì‹œìŠ¤í…œì—ì„œ ë‚´ë ¤ë°›ì€ í•™ìƒë³„ ìˆ˜ì—…ì‹œê°„í‘œ Excel íŒŒì¼ ì—…ë¡œë“œ
  - **ì—¬ëŸ¬ íŒŒì¼ ë™ì‹œ ì—…ë¡œë“œ ì§€ì›** (`multiple` ì†ì„±)
  - íŒŒì¼ í˜•ì‹: `.xlsx`, `.xls`
  - íŒŒì¼ ì„ íƒ ë° ì—…ë¡œë“œ ì²˜ë¦¬
  - ì—…ë¡œë“œ ìƒíƒœ í‘œì‹œ (idle, parsing, saving, done, error)
  - ì—¬ëŸ¬ íŒŒì¼ íŒŒì‹± ë° ì¼ê´„ ì €ì¥
  - ë‹¬ë ¥ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°€ê¸° ë²„íŠ¼
  - **í•™ìƒ ì‹œê°„í‘œ ì¡°íšŒ ì»´í¬ë„ŒíŠ¸ í†µí•©** (`StudentTimetableViewer`)
- Props: `school`, `year`, `semester`, `onBack`
- í˜„ì¬ ìƒíƒœ:
  - UI êµ¬ì¡° ë° ìŠ¤íƒ€ì¼ ì™„ì„±
  - **Excel íŒŒì„œ êµ¬í˜„ ì™„ë£Œ** (`infra/excel/studentTimetableParser.ts`)
  - **Supabase ì €ì¥ ë¡œì§ êµ¬í˜„ ì™„ë£Œ** (`storage.saveStudentTimetables()`)
  - **ì—¬ëŸ¬ íŒŒì¼ ì—…ë¡œë“œ ì§€ì›**
- Import:
  - CSS íŒŒì¼: `./StudentTimetableUpload.css`
  - `parseStudentTimetable` from `../infra/excel/studentTimetableParser`
  - `storage` from `../infra/supabase/storage`
  - `StudentTimetableViewer` from `./StudentTimetableViewer`
- ì£¼ìš” ìƒíƒœ:
  - `files`: ì„ íƒëœ íŒŒì¼ ë°°ì—´ (ì—¬ëŸ¬ íŒŒì¼ ì§€ì›)
  - `status`: ì—…ë¡œë“œ ìƒíƒœ (`'idle' | 'parsing' | 'saving' | 'done' | 'error'`)
  - `message`: ìƒíƒœ ë©”ì‹œì§€

### `StudentTimetableViewer.tsx`
- ì—­í• : í•™ìƒ ì‹œê°„í‘œ ì¡°íšŒ í™”ë©´ (í•™ë²ˆìœ¼ë¡œ ê²€ìƒ‰)
- ê¸°ëŠ¥:
  - í•™ë²ˆ ì…ë ¥ìœ¼ë¡œ í•™ìƒ ì‹œê°„í‘œ ì¡°íšŒ
  - í•™ë²ˆ ìë™ ë³´ì • (5ìë¦¬ë¡œ íŒ¨ë”©, ì˜ˆ: "601" â†’ "00601")
  - Enter í‚¤ë¡œ ê²€ìƒ‰ ê°€ëŠ¥
  - ìš”ì¼/êµì‹œë³„ ì‹œê°„í‘œ í…Œì´ë¸” í‘œì‹œ
  - í•™ìƒ ì •ë³´ í‘œì‹œ (í•™êµ, í•™ë…„ë„, í•™ê¸°, í•™ë…„, ë°˜, ë²ˆí˜¸, ì´ë¦„)
  - ê³¼ëª© ë° êµì‚¬ëª… í‘œì‹œ
  - ì¡°íšŒ ê²°ê³¼ ì—†ì„ ë•Œ ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
- Props: `school`, `year`, `semester`
- Import:
  - `storage` from `../infra/supabase/storage`
  - `StudentBaseTimetableRow` from `../types`
- ì£¼ìš” ìƒíƒœ:
  - `code`: ì…ë ¥ëœ í•™ë²ˆ
  - `rows`: ì¡°íšŒëœ ì‹œê°„í‘œ ë°ì´í„°
  - `loading`: ì¡°íšŒ ì¤‘ ì—¬ë¶€
  - `errorMsg`: ì—ëŸ¬ ë©”ì‹œì§€

### `TeacherTimetable.tsx` / `TeacherTimetable.css`
- ì—­í• : êµì‚¬ ì‹œê°„í‘œ í…Œì´ë¸” í‘œì‹œ (ìš”ì¼/êµì‹œë³„)
- ê¸°ëŠ¥:
  - ì„ íƒëœ êµì‚¬ì˜ ì‹œê°„í‘œë¥¼ ìš”ì¼(ì›”~ê¸ˆ) Ã— êµì‹œ(1~7) í…Œì´ë¸”ë¡œ í‘œì‹œ
  - ê° ì…€ì— í•™ë…„/ë°˜/ê³¼ëª© ì •ë³´ í‘œì‹œ (ì˜ˆ: "206 ì§€â… ")
  - ì—¬ëŸ¬ ìˆ˜ì—…ì´ ìˆëŠ” ê²½ìš° ì¤„ë°”ê¿ˆìœ¼ë¡œ í‘œì‹œ
  - êµì‚¬ ì´ë¦„ í‘œì‹œ
- Props:
  - `schedules`: ì „ì²´ ì‹œê°„í‘œ ë°ì´í„°
  - `teacherId`: í‘œì‹œí•  êµì‚¬ ID
  - `teacherName`: êµì‚¬ ì´ë¦„ (ì˜µì…˜)
- íŠ¹ì§•: `TeacherScheduleUpload` ì»´í¬ë„ŒíŠ¸ ë‚´ì—ì„œ ì‚¬ìš©ë¨

### `ClassSessionTable.tsx` / `ClassSessionTable.css`
- ì—­í• : ìƒì„±ëœ ìˆ˜ì—… ì¼ì • í…Œì´ë¸” í‘œì‹œ
- ê¸°ëŠ¥:
  - íšŒì°¨, ë‚ ì§œ, ìš”ì¼, êµì‹œ, ë°˜, í•™ì‚¬ì¼ì •, ìˆ˜ì—… ë‚´ìš© í‘œì‹œ
  - ìˆ˜ì—… ë‚´ìš© í´ë¦­ í¸ì§‘ (ì¸ë¼ì¸ í¸ì§‘)
  - Enter/Escape í‚¤ë¡œ ì €ì¥/ì·¨ì†Œ
  - í…Œì´ë¸” ìŠ¤í¬ë¡¤ ë° ë°˜ì‘í˜• ë ˆì´ì•„ì›ƒ
  - êµì‚¬ ì´ë¦„ ë° ë°˜ ì •ë³´ í—¤ë” í‘œì‹œ
  - **ì „ì²´ ì €ì¥ ë²„íŠ¼** (ì˜µì…˜, `onSaveAll` ì½œë°±)
- Props: `sessions`, `teacherName`, `classInfo`, `onContentChange`, `onSaveAll?` (ì˜µì…˜)

### `LessonPlanTemplateEditor.tsx` / `LessonPlanTemplateEditor.css`
- ì—­í• : ê³µí†µ ìˆ˜ì—… ê³„íš í…œí”Œë¦¿ í¸ì§‘ í™”ë©´
- ê¸°ëŠ¥:
  - íŠ¹ì • êµì‚¬/í•™ë…„/ê³¼ëª©ì˜ ê³µí†µ ìˆ˜ì—… ê³„íš í…œí”Œë¦¿ í¸ì§‘
  - **íƒ­ ê¸°ëŠ¥ìœ¼ë¡œ ì—¬ëŸ¬ ì‹œí—˜ êµ¬ê°„ ê´€ë¦¬**:
    - "1ì°¨ ì§€í•„ ì´ì „" íƒ­ (`before_first`)
    - "2ì°¨ ì§€í•„ ì´ì „" íƒ­ (`between_first_second`)
    - ê° íƒ­ë³„ë¡œ ë…ë¦½ì ì¸ í…œí”Œë¦¿ í¸ì§‘ ê°€ëŠ¥
  - í•´ë‹¹ ì¡°ê±´ì˜ ëª¨ë“  ë°˜ ì„¸ì…˜ ì¡°íšŒ ë° ë¶„ì„
  - ìµœì†Œ íšŒì°¨ ìë™ ê³„ì‚° (ë°˜ì´ 2ê°œ ì´ìƒì¸ ê²½ìš°)
  - í…œí”Œë¦¿ í–‰ í¸ì§‘ (íšŒì°¨ë³„ ìˆ˜ì—… ë‚´ìš©)
  - ìµœì†Œ íšŒì°¨ ì´í›„ íšŒì°¨ ë‚´ìš© ì„¤ì • (ì˜ˆ: "ììŠµ")
  - í…œí”Œë¦¿ ì €ì¥ (`storage.saveLessonPlanTemplates()`)
  - í…œí”Œë¦¿ì„ ëª¨ë“  ë°˜ì˜ ì„¸ì…˜ì— ì ìš© (`applyLessonTemplateToClassSessions()`)
  - ëª¨ë‹¬ ë°©ì‹ìœ¼ë¡œ í‘œì‹œ
  - í™œì„± ì„¸ê·¸ë¨¼íŠ¸ ë³€ê²½ ì‹œ í•´ë‹¹ êµ¬ê°„ ê¸°ì¤€ìœ¼ë¡œ ìë™ ì¬ë¶„ì„/ë¡œë“œ
- Props:
  - `school`, `year`, `semester`, `teacherId`, `teacherName`, `grade`, `subject`, `segment`, `onClose`
- Import:
  - `storage` from `../infra/supabase/storage`
  - `analyzeCommonPlanForSegment` from `../core/domain/sessions`
  - `applyLessonTemplateToClassSessions` from `../infra/supabase/sessionProcessor`
- ì£¼ìš” ìƒíƒœ:
  - `activeSegment`: í˜„ì¬ í™œì„±í™”ëœ ì‹œí—˜ êµ¬ê°„ (`ExamSegment`)
  - `minCount`: ìµœì†Œ íšŒì°¨ ìˆ˜
  - `classNumbers`: ëŒ€ìƒ ë°˜ ë²ˆí˜¸ ëª©ë¡
  - `rows`: í…œí”Œë¦¿ í–‰ ë°°ì—´ (íšŒì°¨ë³„ ë‚´ìš©)
  - `extraContent`: ìµœì†Œ íšŒì°¨ ì´í›„ íšŒì°¨ ë‚´ìš©

---

## ğŸ“‚ `src/utils/` ë””ë ‰í† ë¦¬ (ìœ í‹¸ë¦¬í‹°)

### `holidays.ts`
- ì—­í• : ê³µíœ´ì¼ ê³„ì‚° ë° ê´€ë¦¬
- ê¸°ëŠ¥:
  - `getHolidays(year)`: íŠ¹ì • ì—°ë„ì˜ ëª¨ë“  ê³µíœ´ì¼ ë°˜í™˜
  - `getHolidayName(date)`: ë‚ ì§œì˜ ê³µíœ´ì¼ ì´ë¦„ ë°˜í™˜
  - `isPublicHoliday(date)`: ê³µíœ´ì¼ ì—¬ë¶€ í™•ì¸
  - `formatDate(date)`: ë‚ ì§œë¥¼ YYYY-MM-DD í˜•ì‹ìœ¼ë¡œ ë³€í™˜
  - `getSubstituteHoliday()`: ëŒ€ì²´ê³µíœ´ì¼ ê³„ì‚° (ì£¼ë§ ê²¹ì¹¨ ì²˜ë¦¬)
  - `getLunarHolidays()`: ìŒë ¥ ê³µíœ´ì¼ ë°ì´í„° (ì„¤ë‚ , ì¶”ì„, ë¶€ì²˜ë‹˜ì˜¤ì‹ ë‚ , 2020-2030ë…„)
- í¬í•¨ ê³µíœ´ì¼:
  - ì–‘ë ¥: ì‹ ì •, ì‚¼ì¼ì ˆ, ì–´ë¦°ì´ë‚ , í˜„ì¶©ì¼, ê´‘ë³µì ˆ, ê°œì²œì ˆ, í•œê¸€ë‚ , í¬ë¦¬ìŠ¤ë§ˆìŠ¤
  - ìŒë ¥: ì„¤ë‚ , ì¶”ì„, ë¶€ì²˜ë‹˜ì˜¤ì‹ ë‚ 
- íŠ¹ì§•: ëŒ€ì²´ê³µíœ´ì¼ ìë™ ê³„ì‚° (ê³µíœ´ì¼ì´ ì£¼ë§ê³¼ ê²¹ì¹˜ë©´ ë‹¤ìŒ í‰ì¼ë¡œ)

### `scheduleMatcher.ts`
- ì—­í• : íŒŒì‹±ëœ ì‹œê°„í‘œì™€ í•™ì‚¬ì¼ì •ì„ ë§¤ì¹­í•˜ì—¬ ìˆ˜ì—… íšŒì°¨ ìƒì„±
- ê¸°ëŠ¥:
  - `generateClassSessions()`: êµì‚¬/í•™ë…„/ë°˜ë³„ ìˆ˜ì—… ì¼ì • ìƒì„±
    - íŒŒë¼ë¯¸í„°: `teacherId`, `grade`, `classNumber`, `schoolId`, `year`, `semester`, `schedules`, `calendar`
    - ë°˜í™˜: `ClassSession[]`
    - **`segment` í•„ë“œ ìë™ ì„¤ì •**:
      - `'before_first'`: 1ì°¨ ì§€í•„ ì´ì „
      - `'between_first_second'`: 1ì°¨ ì§€í•„ ì´í›„ ~ 2ì°¨ ì§€í•„ ì´ì „
      - `'after_second'`: 2ì°¨ ì§€í•„ ì´í›„
      - ìˆ˜ì—… ì—†ëŠ” ë‚ (ê³µíœ´ì¼/ì‹œí—˜ì¼ ë“±)ì€ `undefined`
  - `findTestDates()`: 1ì°¨/2ì°¨ ì§€í•„í‰ê°€ ë‚ ì§œ ì°¾ê¸°
  - `isNonClassDay()`: ìˆ˜ì—… ì—†ëŠ” ë‚  í™•ì¸ (ê³µíœ´ì¼, ì‹œí—˜ì¼, ì¬ëŸ‰íœ´ì—…ì¼, ëª¨ì˜ê³ ì‚¬, ì§ì ‘ì…ë ¥ ë“±)
  - íšŒì°¨ ì¹´ìš´íŒ… ë¡œì§:
    - 1ì°¨ ì§€í•„ ì´ì „: 1ë¶€í„° ì¹´ìš´íŒ… (`sessionNumberBeforeFirst`)
    - 1ì°¨ ì§€í•„ ì´í›„ ~ 2ì°¨ ì§€í•„ ì´ì „: 1ë¶€í„° ë‹¤ì‹œ ì¹´ìš´íŒ… (`sessionNumberAfterFirst`)
    - 2ì°¨ ì§€í•„ ì´í›„ ~ ë°©í•™ì‹ ì „: 1ë¶€í„° ë‹¤ì‹œ ì¹´ìš´íŒ… (`sessionNumberAfterSecond`)
  - íŠ¹ë³„ ì´ë²¤íŠ¸ í–‰ ì‚½ì…:
    - ê°œí•™ì‹ ë‚ ì§œ
    - 1ì°¨ ì§€í•„ ì‹œì‘ ë‚ ì§œ (í•´ë‹¹ í•™ë…„ ê¸°ì¤€)
    - 2ì°¨ ì§€í•„ ì‹œì‘ ë‚ ì§œ (í•´ë‹¹ í•™ë…„ ê¸°ì¤€)
    - ë°©í•™ì‹ ë‚ ì§œ
  - ì£¼ë§ ìë™ ì œì™¸
  - í•™ê¸° ê¸°ê°„ ê³„ì‚°:
    - 1í•™ê¸°: 2ì›” 1ì¼ ~ 8ì›” 31ì¼
    - 2í•™ê¸°: 8ì›” 1ì¼ ~ ë‹¤ìŒí•´ 1ì›” 31ì¼
  - ê°œí•™ì‹/ë°©í•™ì‹ ë‚ ì§œ ë°˜ì˜:
    - ê°œí•™ì‹ì´ ìˆìœ¼ë©´ ê°œí•™ì‹ë¶€í„° ì‹œì‘
    - ë°©í•™ì‹ì´ ìˆìœ¼ë©´ ë°©í•™ì‹ ì „ë‚ ê¹Œì§€ë§Œ ìˆ˜ì—…
  - ëª¨ë“  êµì‹œ í¬í•¨ (í•´ë‹¹ ìš”ì¼ì— ìˆ˜ì—…ì´ ìˆëŠ” ëª¨ë“  êµì‹œ ìƒì„±)
  - í•™ë…„ë³„ ì´ë²¤íŠ¸ í•„í„°ë§ (`isEventForGrade` í•¨ìˆ˜)
- ì°¸ê³ : í–¥í›„ `src/core/domain/sessions.ts`ë¡œ ì´ë™ ì˜ˆì •

---

## ğŸ—„ï¸ Supabase ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡°

### í…Œì´ë¸” 1: `schools`
- ì»¬ëŸ¼:
  - `id` (text, primary key)
  - `name` (text, not null)
  - `created_at` (timestamptz)
  - `updated_at` (timestamptz)
- Unique ì œì•½ì¡°ê±´: `id`

### í…Œì´ë¸” 2: `calendars`
- ì»¬ëŸ¼:
  - `id` (text, primary key)
  - `school_id` (text, not null)
  - `school_name` (text, not null)
  - `year` (integer, not null)
  - `semester` (integer, not null, check: 1 or 2)
  - `events` (jsonb, not null) - `CalendarEvent[]` ë°°ì—´
  - `created_at` (timestamptz)
  - `updated_at` (timestamptz)
  - `saved_at` (timestamptz)
- Unique ì œì•½ì¡°ê±´: `(school_id, year, semester)`
- Upsert ì¶©ëŒ ê¸°ì¤€: `school_id,year,semester`

### í…Œì´ë¸” 3: `teacher_schedules`
- ì»¬ëŸ¼:
  - `id` (uuid, primary key, default: gen_random_uuid())
  - `school_id` (text, not null)
  - `year` (integer, not null)
  - `semester` (integer, not null, check: 1 or 2)
  - `teacher_id` (text, not null)
  - `teacher_name` (text, not null)
  - `subject` (text, not null)
  - `grade` (integer, not null)
  - `class_number` (integer, not null)
  - `day_of_week` (integer, not null, check: 0-6)
  - `period` (integer, not null, check: 1-7)
  - `created_at` (timestamptz)
  - `updated_at` (timestamptz)
- Unique ì œì•½ì¡°ê±´: `(school_id, year, semester, teacher_id, grade, class_number, day_of_week, period)`
- ì¸ë±ìŠ¤: `(school_id, year, semester, teacher_id, grade, class_number)`

### í…Œì´ë¸” 4: `class_sessions`
- ì»¬ëŸ¼:
  - `id` (uuid, primary key, default: gen_random_uuid())
  - `school_id` (text, not null)
  - `year` (integer, not null)
  - `semester` (integer, not null, check: 1 or 2)
  - `teacher_id` (text, not null)
  - `teacher_name` (text, not null)
  - `grade` (integer, not null)
  - `class_number` (integer, not null)
  - `subject` (text, not null)
  - `session_number` (integer, nullable) - íšŒì°¨
  - `date` (date, not null) - YYYY-MM-DD
  - `day_of_week` (text, not null) - "ì›”ìš”ì¼", "í™”ìš”ì¼" ë“±
  - `period` (integer, not null) - êµì‹œ
  - `class_info` (text, not null) - "206 ì§€â… " í˜•ì‹
  - `academic_event` (text, default: '') - í•™ì‚¬ì¼ì •
  - `content` (text, default: '') - ìˆ˜ì—… ë‚´ìš©
  - `is_before_first_test` (boolean, default: false)
  - **`segment` (text, nullable)** - ì‹œí—˜ êµ¬ê°„ êµ¬ë¶„ (`'before_first' | 'between_first_second' | 'after_second'`)
  - `created_at` (timestamptz)
  - `updated_at` (timestamptz)
- Unique ì œì•½ì¡°ê±´: `(school_id, year, semester, teacher_id, grade, class_number, date, period)`
- ì¸ë±ìŠ¤:
  - `(school_id, year, semester, teacher_id, grade, class_number)`
  - `(date)`

### í…Œì´ë¸” 5: `lesson_plan_templates`
- ì»¬ëŸ¼:
  - `id` (uuid, primary key, default: gen_random_uuid())
  - `school_id` (text, not null)
  - `year` (integer, not null)
  - `semester` (integer, not null, check: 1 or 2)
  - `teacher_id` (text, not null)
  - `grade` (integer, not null)
  - `subject` (text, not null)
  - `segment` (text, not null) - `'before_first' | 'between_first_second' | 'after_second'`
  - `session_index` (integer, not null) - íšŒì°¨ ë²ˆí˜¸ (1, 2, 3, ...)
  - `content` (text, not null) - ìˆ˜ì—… ë‚´ìš©
  - `created_at` (timestamptz)
  - `updated_at` (timestamptz)
- Unique ì œì•½ì¡°ê±´: `(school_id, year, semester, teacher_id, grade, subject, segment, session_index)`
- Upsert ì¶©ëŒ ê¸°ì¤€: `school_id,year,semester,teacher_id,grade,subject,segment,session_index`

### í…Œì´ë¸” 6: `student_timetables`
- **í˜„ì¬ ìƒíƒœ: êµ¬í˜„ ì™„ë£Œ**
- ì»¬ëŸ¼:
  - `id` (uuid, primary key, default: gen_random_uuid())
  - `school_id` (text, not null)
  - `year` (integer, not null)
  - `semester` (integer, not null, check: 1 or 2)
  - `grade` (integer, not null)
  - `class_no` (integer, not null)
  - `student_no` (integer, not null)
  - `student_name` (text, not null)
  - `day_of_week` (integer, not null, check: 1-5)
  - `period` (integer, not null, check: 1-7)
  - `subject` (text, not null)
  - `teacher_id` (text, nullable)
  - `teacher_name` (text, nullable)
  - `room` (text, nullable) - êµì‹¤ ì •ë³´
  - `student_code` (text, generated column) - í•™ë²ˆ (5ìë¦¬, ì˜ˆ: "30601")
  - `created_at` (timestamptz)
  - `updated_at` (timestamptz)
- Unique ì œì•½ì¡°ê±´: `(school_id, year, semester, grade, class_no, student_no, day_of_week, period)`
- ì¸ë±ìŠ¤: `(school_id, year, semester, student_code)` (í•™ë²ˆ ì¡°íšŒ ìµœì í™”)

---

## ğŸ”„ ë°ì´í„° íë¦„

```
1. SchoolSelection 
   â†’ Supabaseì—ì„œ í•™êµ ëª©ë¡ ì¡°íšŒ (infra/supabase/storage)
   â†’ í•™êµ ì´ë¦„ ì…ë ¥ ì‹œ ë¶€ë¶„ ì¼ì¹˜ ê²€ìƒ‰ (searchSchoolsByName)
   â†’ ì¶”ì²œ ë¦¬ìŠ¤íŠ¸ í‘œì‹œ ë˜ëŠ” ì •í™•í•œ ì¼ì¹˜ í™•ì¸
   â†’ í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜ (ArrowDown/ArrowUp/Enter) ì§€ì›
   â†’ í•™êµ ì„ íƒ/ë“±ë¡
   â†“

2. YearSemesterSelection 
   â†’ í•™ë…„ë„/í•™ê¸° ì„ íƒ
   â†“

3. CalendarEditor 
   â†’ Supabaseì—ì„œ ê¸°ì¡´ í•™ì‚¬ì¼ì • ë¡œë“œ (infra/supabase/storage)
   â†’ 2í•™ê¸° ì„ íƒ ì‹œ 1í•™ê¸° 8ì›” ë°ì´í„° ìë™ ë¡œë“œ
   â†’ ê³µíœ´ì¼ ìë™ ì¶”ê°€
   â†’ í•™ì‚¬ì¼ì • í¸ì§‘ (ëª¨ë‹¬ ë°©ì‹)
   â†’ í•™ë…„ë³„ í•„í„°ë§ìœ¼ë¡œ ë‹¬ë ¥ í‘œì‹œ
   â†’ Supabaseì— ì €ì¥ (upsert, ì¶©ëŒ ê¸°ì¤€: school_id,year,semester)
   â†’ ë§ˆì§€ë§‰ ì €ì¥ ì‹œê°„ í‘œì‹œ
   â†’ ë³€ê²½ ì‚¬í•­ ê°ì§€
   â†’ ë‹¤ìŒ ë‹¨ê³„ ì„ íƒ:
     - "ë‹¤ìŒ: êµì‚¬ ì‹œê°„í‘œ ì…ë ¥ â†’" (onNext)
     - "ë‹¤ìŒ: í•™ìƒ ì‹œê°„í‘œ ì…ë ¥ â†’" (onNextStudentTimetable)
   â†“

4. TeacherScheduleUpload 
   â†’ Excel íŒŒì¼ ì—…ë¡œë“œ
   â†“
   
   infra/excel/excelParser.ts 
   â†’ Excel íŒŒì‹± (ClassSchedule[] ë°˜í™˜)
   â†’ ë‘ ì¤„ë¡œ ë‚˜ë‰œ í–‰ ë³‘í•© ì²˜ë¦¬
   â†“
   
   infra/supabase/storage.saveTeacherSchedules()
   â†’ Supabase teacher_schedules í…Œì´ë¸”ì— ì €ì¥
   (ê¸°ì¡´ ë°ì´í„° ì‚­ì œ í›„ ìƒˆ ë°ì´í„° ì‚½ì…)
   â†“
   
   ë˜ëŠ” ê¸°ì¡´ ì €ì¥ëœ ì‹œê°„í‘œ ë¡œë“œ
   â†’ storage.getTeacherSchedules()ë¡œ DBì—ì„œ ì¡°íšŒ
   â†“
   
   êµì‚¬ ê²€ìƒ‰ ë° ì„ íƒ (í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜ ì§€ì›: â†‘, â†“, Enter)
   â†’ ë¶„ê¸° ì„ íƒ:
     - plan: í•™ê¸‰ë³„ ì§„ë„ ê³„íší‘œ
       â†’ í•™ë…„/ê³¼ëª©/ë°˜ ì„ íƒ
       â†’ ìë™ìœ¼ë¡œ DBì—ì„œ ìˆ˜ì—… ì¼ì • ë¡œë“œ ì‹œë„ (loadSessionsFromDB)
       â†’ DBì— ì—†ìœ¼ë©´ utils/scheduleMatcher.tsë¡œ ìˆ˜ì—… ì¼ì • ìƒì„± (fallback)
       â†’ ìƒì„± ì‹œ segment í•„ë“œ ìë™ ì„¤ì • (before_first/between_first_second/after_second)
       â†’ ClassSessionTableë¡œ í‘œì‹œ
       â†’ ì „ì²´ ì €ì¥ ë²„íŠ¼ìœ¼ë¡œ Supabaseì— ì €ì¥ (segment í¬í•¨)
       â†’ ê³µí†µ ìˆ˜ì—… ê³„íš í…œí”Œë¦¿ í¸ì§‘ê¸° ì—´ê¸° (LessonPlanTemplateEditor)
     - timetable: êµì‚¬ ì‹œê°„í‘œ
       â†’ TeacherTimetable ì»´í¬ë„ŒíŠ¸ë¡œ ìš”ì¼/êµì‹œë³„ í…Œì´ë¸” í‘œì‹œ
   â†“
   
   ë˜ëŠ” ì „ì²´ ìë™ ìƒì„±
   â†’ infra/supabase/sessionProcessor.processAllClassSessions()
   â†’ ëª¨ë“  êµì‚¬/í•™ê¸‰ì— ëŒ€í•´ ìˆ˜ì—… ì„¸ì…˜ ì¼ê´„ ìƒì„± ë° ì €ì¥ (segment í¬í•¨)
   â†“
   
   infra/supabase/storage.saveClassSessions()
   â†’ Supabase class_sessions í…Œì´ë¸”ì— ì €ì¥ (segment í•„ë“œ í¬í•¨)
   (ê¸°ì¡´ ë°ì´í„° ì‚­ì œ í›„ ìƒˆ ë°ì´í„° ì‚½ì…)
   â†“

5. StudentTimetableUpload (êµ¬í˜„ ì™„ë£Œ)
   â†’ ë‚˜ì´ìŠ¤ ì‹œìŠ¤í…œì—ì„œ ë‚´ë ¤ë°›ì€ í•™ìƒë³„ ìˆ˜ì—…ì‹œê°„í‘œ Excel íŒŒì¼ ì—…ë¡œë“œ
   â†’ ì—¬ëŸ¬ íŒŒì¼ ë™ì‹œ ì—…ë¡œë“œ ì§€ì› (multiple)
   â†“
   
   infra/excel/studentTimetableParser.ts
   â†’ Excel íŒŒì‹± (StudentBaseTimetableRow[] ë°˜í™˜)
   â†’ ê° íŒŒì¼ë³„ë¡œ íŒŒì‹± í›„ ê²°ê³¼ ë³‘í•©
   â†“
   
   infra/supabase/storage.saveStudentTimetables()
   â†’ Supabase student_timetables í…Œì´ë¸”ì— ì €ì¥
   (ê¸°ì¡´ ë°ì´í„° ì‚­ì œ í›„ ìƒˆ ë°ì´í„° ì‚½ì…)
   â†“
   
   StudentTimetableViewer
   â†’ í•™ë²ˆìœ¼ë¡œ í•™ìƒ ì‹œê°„í‘œ ì¡°íšŒ
   â†’ storage.getStudentTimetableByStudentCode() í˜¸ì¶œ
   â†’ ìš”ì¼/êµì‹œë³„ ì‹œê°„í‘œ í…Œì´ë¸” í‘œì‹œ
   â†“

6. LessonPlanTemplateEditor
   â†’ í•´ë‹¹ êµì‚¬/í•™ë…„/ê³¼ëª©ì˜ ëª¨ë“  ë°˜ ì„¸ì…˜ ì¡°íšŒ (segment í•„ë“œ í¬í•¨)
   â†’ íƒ­ìœ¼ë¡œ ì‹œí—˜ êµ¬ê°„ ì„ íƒ (1ì°¨ ì§€í•„ ì´ì „ / 2ì°¨ ì§€í•„ ì´ì „)
   â†’ core/domain/sessions.analyzeCommonPlanForSegment()ë¡œ ìµœì†Œ íšŒì°¨ ë¶„ì„ (segment ê¸°ì¤€)
   â†’ í…œí”Œë¦¿ í¸ì§‘ (íšŒì°¨ë³„ ìˆ˜ì—… ë‚´ìš©)
   â†’ storage.saveLessonPlanTemplates()ë¡œ í…œí”Œë¦¿ ì €ì¥ (segmentë³„ë¡œ ì €ì¥)
   â†’ infra/supabase/sessionProcessor.applyLessonTemplateToClassSessions()ë¡œ ëª¨ë“  ë°˜ì— ì ìš©
   â†“

7. ClassSessionTable 
   â†’ ìˆ˜ì—… ì¼ì • í‘œì‹œ ë° í¸ì§‘
   â†’ ìˆ˜ì—… ë‚´ìš© ì¸ë¼ì¸ í¸ì§‘ (Enter/Escape í‚¤ ì§€ì›)
   â†’ ì „ì²´ ì €ì¥ ë²„íŠ¼ (onSaveAll ì½œë°±)
   (ìˆ˜ì—… ë‚´ìš© ìˆ˜ì • ì‹œ onContentChange ì½œë°±)
```

---

## ğŸ¨ ìŠ¤íƒ€ì¼ íŒŒì¼

ê° ì»´í¬ë„ŒíŠ¸ë§ˆë‹¤ `.css` íŒŒì¼ì´ ìˆì–´ ì»´í¬ë„ŒíŠ¸ë³„ ìŠ¤íƒ€ì¼ì„ ê´€ë¦¬í•©ë‹ˆë‹¤:

- `SchoolSelection.css`
- `YearSemesterSelection.css`
- `CalendarEditor.css`
- `TeacherScheduleUpload.css`
- **`StudentTimetableUpload.css`**
- `TeacherTimetable.css`
- `ClassSessionTable.css`
- `LessonPlanTemplateEditor.css`
- `App.css` (ì „ì—­ ì•± ìŠ¤íƒ€ì¼)
- `index.css` (ì „ì—­ ë¦¬ì…‹ ë° ê¸°ë³¸ ìŠ¤íƒ€ì¼)

---

## ğŸ“ ì£¼ìš” ë³€ê²½ì‚¬í•­ (ìµœì‹  ì—…ë°ì´íŠ¸)

### 1. í•™ìƒ ì‹œê°„í‘œ ì—…ë¡œë“œ ê¸°ëŠ¥ êµ¬í˜„ ì™„ë£Œ
- **`StudentTimetableUpload.tsx` / `StudentTimetableUpload.css` ì»´í¬ë„ŒíŠ¸**
  - ë‚˜ì´ìŠ¤ ì‹œìŠ¤í…œì—ì„œ ë‚´ë ¤ë°›ì€ í•™ìƒë³„ ìˆ˜ì—…ì‹œê°„í‘œ Excel íŒŒì¼ ì—…ë¡œë“œ UI
  - **ì—¬ëŸ¬ íŒŒì¼ ë™ì‹œ ì—…ë¡œë“œ ì§€ì›** (`multiple` ì†ì„±)
  - íŒŒì¼ ì„ íƒ ë° ì—…ë¡œë“œ ìƒíƒœ ê´€ë¦¬
  - **Excel íŒŒì„œ êµ¬í˜„ ì™„ë£Œ** (`infra/excel/studentTimetableParser.ts`)
  - **Supabase ì €ì¥ ë¡œì§ êµ¬í˜„ ì™„ë£Œ** (`storage.saveStudentTimetables()`)
- **`StudentTimetableViewer.tsx` ì»´í¬ë„ŒíŠ¸ ì¶”ê°€**
  - í•™ë²ˆìœ¼ë¡œ í•™ìƒ ì‹œê°„í‘œ ì¡°íšŒ ê¸°ëŠ¥
  - ìš”ì¼/êµì‹œë³„ ì‹œê°„í‘œ í…Œì´ë¸” í‘œì‹œ
  - Enter í‚¤ë¡œ ê²€ìƒ‰ ì§€ì›
- **`App.tsx`ì— `student-timetable` ë‹¨ê³„ ì¶”ê°€**
  - ë‹¬ë ¥ í¸ì§‘ í™”ë©´ì—ì„œ í•™ìƒ ì‹œê°„í‘œ ì…ë ¥ í™”ë©´ìœ¼ë¡œ ì´ë™ ê°€ëŠ¥
- **`CalendarEditor.tsx`ì— `onNextStudentTimetable` ì½œë°± ì¶”ê°€**
  - "ë‹¤ìŒ: í•™ìƒ ì‹œê°„í‘œ ì…ë ¥ â†’" ë²„íŠ¼ ì¶”ê°€
  - ì €ì¥ ì™„ë£Œ í›„ì—ë§Œ í‘œì‹œ

### 2. í•™ìƒ ì‹œê°„í‘œ íŒŒì„œ êµ¬í˜„
- **`src/infra/excel/studentTimetableParser.ts` ì¶”ê°€**
  - ë‚˜ì´ìŠ¤ "í•™ìƒë³„ ìˆ˜ì—…ì‹œê°„í‘œ" Excel íŒŒì¼ íŒŒì‹±
  - íŒŒì¼ í¬ë§·: "2025í•™ë…„ë„ 2í•™ê¸° 3í•™ë…„ 6ë°˜ 1ë²ˆ ê°•ì¤€ì˜" í˜•ì‹
  - ìš”ì¼/êµì‹œë³„ ê³¼ëª© ë° êµì‚¬ ì •ë³´ ì¶”ì¶œ
  - êµì‚¬ëª… íŒŒì‹± (ê´„í˜¸ ì²˜ë¦¬)
  - êµì‹¤ ì •ë³´ ì¶”ì¶œ (ìˆëŠ” ê²½ìš°)

### 3. í•™ìƒ ì‹œê°„í‘œ ì €ì¥ ë¡œì§ êµ¬í˜„
- **`storage.saveStudentTimetables()` êµ¬í˜„**
  - ì—¬ëŸ¬ íŒŒì¼ì—ì„œ íŒŒì‹±ëœ ë°ì´í„°ë¥¼ ì¼ê´„ ì €ì¥
  - ê¸°ì¡´ ë°ì´í„° ì‚­ì œ í›„ ìƒˆ ë°ì´í„° ì‚½ì…
  - `student_timetables` í…Œì´ë¸”ì— ì €ì¥
- **`storage.getStudentTimetableByStudentCode()` êµ¬í˜„**
  - í•™ë²ˆìœ¼ë¡œ í•™ìƒ ì‹œê°„í‘œ ì¡°íšŒ
  - í•™ë²ˆ ìë™ ë³´ì • (5ìë¦¬ë¡œ íŒ¨ë”©)
  - `student_code` generated column ì‚¬ìš©

### 4. í•™ìƒ ì‹œê°„í‘œ í…Œì´ë¸” êµ¬í˜„
- **`student_timetables` í…Œì´ë¸” ìƒì„± ì™„ë£Œ**
  - ì»¬ëŸ¼: `school_id`, `year`, `semester`, `grade`, `class_no`, `student_no`, `student_name`, `day_of_week`, `period`, `subject`, `teacher_id`, `teacher_name`, `room`
  - `student_code` generated column (5ìë¦¬ í•™ë²ˆ)
  - Unique ì œì•½ì¡°ê±´ ë° ì¸ë±ìŠ¤ ì„¤ì •

### 5. íƒ€ì… ì¶”ê°€
- **`StudentBaseTimetableRow` íƒ€ì… ì¶”ê°€** (`types.ts`)
  - í•™ìƒ ì‹œê°„í‘œ í–‰ ë°ì´í„° íƒ€ì…
  - Supabase `student_timetables` í…Œì´ë¸”ê³¼ 1:1 ë§¤í•‘

### 6. 3ê³„ì¸µ ì•„í‚¤í…ì²˜ êµ¬ì¡° ë„ì…
- Domain Layer: `src/core/domain/` (ìˆœìˆ˜ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§)
  - `sessions.ts`: ê³µí†µ ìˆ˜ì—… ê³„íš ê´€ë ¨ í•¨ìˆ˜ êµ¬í˜„ ì™„ë£Œ
- Infrastructure Layer: `src/infra/` (ì™¸ë¶€ ì‹œìŠ¤í…œ ì—°ë™)
  - `src/infra/supabase/` (Supabase ê´€ë ¨)
  - `src/infra/excel/` (Excel íŒŒì‹±)
- UI Layer: `src/ui/` (í˜„ì¬ëŠ” ë¹„ì–´ìˆìŒ, í–¥í›„ ì»´í¬ë„ŒíŠ¸ ì´ë™ ì˜ˆì •)

### 7. íŒŒì¼ ì´ë™ ë° êµ¬ì¡° ê°œì„ 
- `src/lib/supabase.ts` â†’ `src/infra/supabase/client.ts`
- `src/utils/storage.ts` â†’ `src/infra/supabase/storage.ts`
- `src/utils/excelParser.ts` â†’ `src/infra/excel/excelParser.ts`

### 8. Import ê²½ë¡œ ì—…ë°ì´íŠ¸
- ëª¨ë“  ì»´í¬ë„ŒíŠ¸ì˜ import ê²½ë¡œê°€ ìƒˆë¡œìš´ êµ¬ì¡°ì— ë§ê²Œ ìˆ˜ì •ë¨
- `storage` import: `../infra/supabase/storage`
- `excelParser` import: `../infra/excel/excelParser`

### 9. Domain Layer í™•ì¥
- `src/core/domain/sessions.ts`ì— ê³µí†µ ìˆ˜ì—… ê³„íš ê´€ë ¨ í•¨ìˆ˜ êµ¬í˜„:
  - `analyzeCommonPlanForSegment()`: ì„¸ê·¸ë¨¼íŠ¸ë³„ ê³µí†µ ê³„íš ë¶„ì„
  - `applyTemplateToSessions()`: í…œí”Œë¦¿ì„ ì„¸ì…˜ì— ì ìš©
  - `computeMinSessionsBySegment()`: ìµœì†Œ íšŒì°¨ ê³„ì‚°
  - `CommonPlanAnalysis` ì¸í„°í˜ì´ìŠ¤ ì¶”ê°€
  - `LessonPlanTemplateRow` íƒ€ì… ì¶”ê°€

### 10. ìƒˆë¡œìš´ ì¸í”„ë¼ íŒŒì¼ ì¶”ê°€
- `src/infra/supabase/sessionProcessor.ts`:
  - `processAllClassSessions()`: ì „ì²´ ìˆ˜ì—… ì„¸ì…˜ ìë™ ìƒì„±
  - `applyLessonTemplateToClassSessions()`: í…œí”Œë¦¿ì„ ì„¸ì…˜ì— ì ìš©

### 11. Storage ê¸°ëŠ¥ í™•ì¥
- `getCalendarFor()`: íŠ¹ì • í•™êµ/ì—°ë„/í•™ê¸°ì˜ í•™ì‚¬ì¼ì • ì¡°íšŒ ì¶”ê°€
- `getClassSessionsByTeacherGradeSubject()`: êµì‚¬/í•™ë…„/ê³¼ëª©ë³„ ëª¨ë“  ë°˜ ì„¸ì…˜ ì¡°íšŒ ì¶”ê°€
- `getLessonPlanTemplates()`: í…œí”Œë¦¿ ì¡°íšŒ ì¶”ê°€
- `saveLessonPlanTemplates()`: í…œí”Œë¦¿ ì €ì¥ ì¶”ê°€
- **`saveClassSessions()`: `segment` í•„ë“œ ì €ì¥ ì§€ì› ì¶”ê°€**
- **`getClassSessions()`: `subject` íŒŒë¼ë¯¸í„° ì¶”ê°€**
- **`getClassSessionsByTeacherGradeSubject()`: `segment` í•„ë“œ ë§¤í•‘ ì¶”ê°€**
- **`saveStudentTimetables()`: í•™ìƒ ì‹œê°„í‘œ ì €ì¥ ì¶”ê°€**
- **`getStudentTimetableByStudentCode()`: í•™ë²ˆìœ¼ë¡œ ì¡°íšŒ ì¶”ê°€**

### 12. ìƒˆë¡œìš´ ì»´í¬ë„ŒíŠ¸ ì¶”ê°€
- `LessonPlanTemplateEditor.tsx`: ê³µí†µ ìˆ˜ì—… ê³„íš í…œí”Œë¦¿ í¸ì§‘ê¸°
  - ìµœì†Œ íšŒì°¨ ìë™ ê³„ì‚°
  - í…œí”Œë¦¿ í¸ì§‘ ë° ì €ì¥
  - ëª¨ë“  ë°˜ì— í…œí”Œë¦¿ ì ìš©
  - **íƒ­ ê¸°ëŠ¥ìœ¼ë¡œ ì—¬ëŸ¬ ì‹œí—˜ êµ¬ê°„ ê´€ë¦¬ (1ì°¨ ì§€í•„ ì´ì „ / 2ì°¨ ì§€í•„ ì´ì „)**
- **`StudentTimetableViewer.tsx`: í•™ìƒ ì‹œê°„í‘œ ì¡°íšŒ ì»´í¬ë„ŒíŠ¸**
  - í•™ë²ˆìœ¼ë¡œ ê²€ìƒ‰
  - ìš”ì¼/êµì‹œë³„ ì‹œê°„í‘œ í‘œì‹œ

### 13. TeacherScheduleUpload ê¸°ëŠ¥ í™•ì¥
- ì „ì²´ ìë™ ìƒì„± ë²„íŠ¼ ì¶”ê°€ (`processAllClassSessions` í˜¸ì¶œ)
- ê³µí†µ ìˆ˜ì—… ê³„íš í…œí”Œë¦¿ í¸ì§‘ê¸° í†µí•© (`LessonPlanTemplateEditor`)
- **ê³¼ëª©(`selectedSubject`) ì„ íƒ ê¸°ëŠ¥ ì¶”ê°€**
- **DBì—ì„œ ìˆ˜ì—… ì¼ì • ìë™ ë¡œë“œ ê¸°ëŠ¥** (`loadSessionsFromDB`):
  - `viewMode`ê°€ `'plan'`ì´ê³  ëª¨ë“  ì„ íƒì´ ì™„ë£Œë˜ë©´ ìë™ìœ¼ë¡œ DBì—ì„œ ì„¸ì…˜ ë¡œë“œ
  - DBì— ì—†ìœ¼ë©´ ê¸°ì¡´ ë°©ì‹ëŒ€ë¡œ í”„ë¡ íŠ¸ì—ì„œ ìƒì„± (fallback)
- **êµì‚¬ ê²€ìƒ‰ í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜ ì¶”ê°€** (ArrowDown/ArrowUp/Enter)

### 14. íƒ€ì… ì¶”ê°€ ë° í™•ì¥
- `ExamSegment`: ì‹œí—˜ êµ¬ê°„ íƒ€ì… (`'before_first' | 'between_first_second' | 'after_second'`)
- `LessonPlanTemplate`: ìˆ˜ì—… ê³„íš í…œí”Œë¦¿ íƒ€ì…
- **`ClassSession.segment`: ì‹œí—˜ êµ¬ê°„ êµ¬ë¶„ í•„ë“œ ì¶”ê°€ (ì˜µì…˜)**
- **`StudentBaseTimetableRow`: í•™ìƒ ì‹œê°„í‘œ í–‰ íƒ€ì… ì¶”ê°€**

### 15. ìƒˆë¡œìš´ í…Œì´ë¸” ì¶”ê°€
- `lesson_plan_templates`: ê³µí†µ ìˆ˜ì—… ê³„íš í…œí”Œë¦¿ ì €ì¥ í…Œì´ë¸”
- **`student_timetables`: í•™ìƒ ì‹œê°„í‘œ ì €ì¥ í…Œì´ë¸” (êµ¬í˜„ ì™„ë£Œ)**

### 16. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ í™•ì¥
- **`class_sessions` í…Œì´ë¸”ì— `segment` ì»¬ëŸ¼ ì¶”ê°€** (text, nullable)
  - ì‹œí—˜ êµ¬ê°„ êµ¬ë¶„: `'before_first'`, `'between_first_second'`, `'after_second'`
- **`student_timetables` í…Œì´ë¸” ìƒì„±**
  - í•™ìƒ ì‹œê°„í‘œ ë°ì´í„° ì €ì¥
  - `student_code` generated column (5ìë¦¬ í•™ë²ˆ)

### 17. scheduleMatcher.ts ê°œì„ 
- í•™ë…„ë³„ ì´ë²¤íŠ¸ í•„í„°ë§ ê¸°ëŠ¥ ì¶”ê°€ (`isEventForGrade`)
- 1ì°¨/2ì°¨ ì§€í•„ ë‚ ì§œë¥¼ í•™ë…„ë³„ë¡œ êµ¬ë¶„í•˜ì—¬ ì°¾ê¸° (`findFirstTestStartDate`, `findSecondTestStartDate`)
- `isNonClassDay` í•¨ìˆ˜ê°€ í•™ë…„ì„ ê³ ë ¤í•˜ì—¬ ìˆ˜ì—… ì—†ëŠ” ë‚  íŒë³„
- **ì„¸ì…˜ ìƒì„± ì‹œ `segment` í•„ë“œ ìë™ ì„¤ì •**:
  - 1ì°¨ ì§€í•„ ì´ì „: `'before_first'`
  - 1ì°¨~2ì°¨ ì§€í•„ ì‚¬ì´: `'between_first_second'`
  - 2ì°¨ ì§€í•„ ì´í›„: `'after_second'`
  - ìˆ˜ì—… ì—†ëŠ” ë‚ (ê³µíœ´ì¼/ì‹œí—˜ì¼ ë“±): `undefined`

### 18. LessonPlanTemplateEditor ê°œì„ 
- **íƒ­ ê¸°ëŠ¥ ì¶”ê°€**: ì—¬ëŸ¬ ì‹œí—˜ êµ¬ê°„ì„ íƒ­ìœ¼ë¡œ ê´€ë¦¬
  - "1ì°¨ ì§€í•„ ì´ì „" íƒ­ (`before_first`)
  - "2ì°¨ ì§€í•„ ì´ì „" íƒ­ (`between_first_second`)
- í™œì„± ì„¸ê·¸ë¨¼íŠ¸ ë³€ê²½ ì‹œ í•´ë‹¹ êµ¬ê°„ ê¸°ì¤€ìœ¼ë¡œ ìë™ ì¬ë¶„ì„/ë¡œë“œ
- ê° êµ¬ê°„ë³„ë¡œ ë…ë¦½ì ì¸ í…œí”Œë¦¿ í¸ì§‘ ë° ì €ì¥ ê°€ëŠ¥

### 19. Domain Layer ì„¸ê·¸ë¨¼íŠ¸ ì²˜ë¦¬ ê°œì„ 
- `isSessionInSegment()` í•¨ìˆ˜ê°€ `segment` í•„ë“œë¥¼ ìš°ì„  ì‚¬ìš©
- `segment` í•„ë“œê°€ ì—†ì„ ë•Œë§Œ ê¸°ì¡´ í”Œë˜ê·¸ ê¸°ë°˜ ë¡œì§(`isBeforeFirstTest` ë“±) ì‚¬ìš©
- í•˜ìœ„ í˜¸í™˜ì„± ìœ ì§€ (ê¸°ì¡´ ë°ì´í„°ë„ ì²˜ë¦¬ ê°€ëŠ¥)

### 20. UI ê°œì„  ì‚¬í•­
- **`SchoolSelection`**:
  - ë¶€ë¶„ ì¼ì¹˜ ê²€ìƒ‰ ë° ì¶”ì²œ ë¦¬ìŠ¤íŠ¸ ê¸°ëŠ¥ ì¶”ê°€
  - **í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜ ì¶”ê°€** (ArrowDown/ArrowUp/Enter)
  - **ê²€ìƒ‰ ì¤‘ ìƒíƒœ ê´€ë¦¬** (`isSearching`): ê²€ìƒ‰ ì¤‘ì—ëŠ” Enter í‚¤ ì…ë ¥ ë°©ì§€
  - **ì¶”ì²œ ë¦¬ìŠ¤íŠ¸ì— "ìƒˆ í•™êµ ë“±ë¡" ì˜µì…˜ í‘œì‹œ**: ì •í™•íˆ ì¼ì¹˜í•˜ëŠ” í•™êµê°€ ì—†ì„ ë•Œë§Œ í‘œì‹œ
- **`TeacherScheduleUpload`**: 
  - êµì‚¬ ê²€ìƒ‰ ê¸°ëŠ¥ ì¶”ê°€ (ì´ë¦„/ì•„ì´ë”” ê²€ìƒ‰, ì¶”ì²œ ë¦¬ìŠ¤íŠ¸)
  - **í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜ ì§€ì›** (â†‘, â†“, Enter)
  - viewMode ë¶„ê¸° ê¸°ëŠ¥ ì¶”ê°€ (plan/timetable)
  - êµì‚¬ ì‹œê°„í‘œ í‘œì‹œ ê¸°ëŠ¥ í†µí•©
  - ì „ì²´ ìë™ ìƒì„± ê¸°ëŠ¥ ì¶”ê°€
  - ê³µí†µ ìˆ˜ì—… ê³„íš í…œí”Œë¦¿ í¸ì§‘ê¸° í†µí•©
  - **ê³¼ëª© ì„ íƒ ê¸°ëŠ¥ ì¶”ê°€**
  - **DBì—ì„œ ìˆ˜ì—… ì¼ì • ìë™ ë¡œë“œ ê¸°ëŠ¥**
- **`CalendarEditor`**:
  - í•™ë…„ë³„ í•„í„° ê¸°ëŠ¥ ì¶”ê°€ (ë‹¬ë ¥ í‘œì‹œ í•„í„°)
  - ë§ˆì§€ë§‰ ì €ì¥ ì‹œê°„ í‘œì‹œ
  - ë³€ê²½ ì‚¬í•­ ê°ì§€ (`isModified`)
  - 2í•™ê¸° ì„ íƒ ì‹œ 1í•™ê¸° 8ì›” ë°ì´í„° ìë™ ë¡œë“œ
  - ëª¨ë‹¬ ë°©ì‹ìœ¼ë¡œ ì´ë²¤íŠ¸ í¸ì§‘
  - **"ë‹¤ìŒ: í•™ìƒ ì‹œê°„í‘œ ì…ë ¥ â†’" ë²„íŠ¼ ì¶”ê°€**
- **`StudentTimetableUpload`**:
  - **ì—¬ëŸ¬ íŒŒì¼ ë™ì‹œ ì—…ë¡œë“œ ì§€ì›**
  - **í•™ìƒ ì‹œê°„í‘œ ì¡°íšŒ ì»´í¬ë„ŒíŠ¸ í†µí•©** (`StudentTimetableViewer`)
- **`ClassSessionTable`**: Enter/Escape í‚¤ ì§€ì›, **ì „ì²´ ì €ì¥ ë²„íŠ¼ ì¶”ê°€** (`onSaveAll` ì½œë°±)

### 21. Excel íŒŒì„œ ê°œì„ 
- ë‘ ì¤„ë¡œ ë‚˜ë‰œ í–‰ ë³‘í•© ì²˜ë¦¬ (`mergeTwoRows` í•¨ìˆ˜)
  - êµì‚¬ ì´ë¦„ì´ ë‘ ì¤„ë¡œ ë‚˜ë‰œ ê²½ìš° ë³‘í•©
  - ê³¼ëª©ëª…ì´ ë‘ ì¤„ë¡œ ë‚˜ë‰œ ê²½ìš° ë³‘í•©
- **í•™ìƒ ì‹œê°„í‘œ íŒŒì„œ êµ¬í˜„** (`studentTimetableParser.ts`)
  - ë‚˜ì´ìŠ¤ "í•™ìƒë³„ ìˆ˜ì—…ì‹œê°„í‘œ" Excel íŒŒì¼ íŒŒì‹±
  - í•™ìƒ ì •ë³´, ìš”ì¼/êµì‹œë³„ ê³¼ëª© ë° êµì‚¬ ì •ë³´ ì¶”ì¶œ

---

## ğŸ”§ í™˜ê²½ ì„¤ì •

### í•„ìˆ˜ í™˜ê²½ ë³€ìˆ˜ (`.env` íŒŒì¼)
```env
VITE_SUPABASE_URL=https://your-project.supabase.co
VITE_SUPABASE_ANON_KEY=your-anon-key
```

### Supabase í…Œì´ë¸” ìƒì„±
1. `schools` í…Œì´ë¸” ìƒì„±
2. `calendars` í…Œì´ë¸” ìƒì„± (Unique: `school_id,year,semester`)
3. `teacher_schedules` í…Œì´ë¸” ìƒì„±
4. `class_sessions` í…Œì´ë¸” ìƒì„± (**`segment` ì»¬ëŸ¼ í¬í•¨**)
5. `lesson_plan_templates` í…Œì´ë¸” ìƒì„± (Unique: `school_id,year,semester,teacher_id,grade,subject,segment,session_index`)
6. **`student_timetables` í…Œì´ë¸” ìƒì„± (êµ¬í˜„ ì™„ë£Œ)**
   - `student_code` generated column í¬í•¨
   - ì¸ë±ìŠ¤: `(school_id, year, semester, student_code)`

---

## ğŸ¯ í–¥í›„ ê³„íš

1. Domain Layer í™•ì¥
   - `scheduleMatcher.ts`ì˜ ìˆœìˆ˜ ë¡œì§ì„ `src/core/domain/sessions.ts`ë¡œ ì´ë™
   - React/Supabase ì˜ì¡´ì„± ì œê±°
   - ìˆœìˆ˜ í•¨ìˆ˜ë¡œ ë¦¬íŒ©í† ë§

2. UI Layer ì •ë¦¬
   - `src/components/`ì˜ ì»´í¬ë„ŒíŠ¸ë¥¼ `src/ui/`ë¡œ ì´ë™ ê²€í† 

3. í…ŒìŠ¤íŠ¸ ì¶”ê°€
   - Domain Layerì˜ ìˆœìˆ˜ í•¨ìˆ˜ë“¤ì— ëŒ€í•œ unit test ì‘ì„±

4. ê¸°ëŠ¥ ê°œì„ 
   - ìˆ˜ì—… ë‚´ìš© ìˆ˜ì • ì‹œ Supabaseì— ìë™ ì €ì¥ ê¸°ëŠ¥
   - ìˆ˜ì—… ì„¸ì…˜ ì¡°íšŒ ë° í¸ì§‘ ê¸°ëŠ¥ ê°•í™”
   - êµì‚¬ ì‹œê°„í‘œ ë‚´ë³´ë‚´ê¸° ê¸°ëŠ¥
   - ë‹¤ë¥¸ ì‹œí—˜ êµ¬ê°„(`between_first_second`, `after_second`) ì§€ì› í™•ì¥
   - `LessonPlanTemplateEditor`ì— "2ì°¨ ì§€í•„ ì´í›„" íƒ­ ì¶”ê°€ ê²€í† 
   - í•™ìƒ ì‹œê°„í‘œ ì¡°íšŒ ê¸°ëŠ¥ í™•ì¥ (ë°˜ë³„, í•™ë…„ë³„ ì¡°íšŒ ë“±)

---

## ğŸ“Œ ìµœì‹  ì—…ë°ì´íŠ¸ ìš”ì•½ (2024)

### ì£¼ìš” ë³€ê²½ì‚¬í•­
1. **í•™ìƒ ì‹œê°„í‘œ ì—…ë¡œë“œ ê¸°ëŠ¥ êµ¬í˜„ ì™„ë£Œ**
   - `StudentTimetableUpload` ì»´í¬ë„ŒíŠ¸ (ì—¬ëŸ¬ íŒŒì¼ ì—…ë¡œë“œ ì§€ì›)
   - `StudentTimetableViewer` ì»´í¬ë„ŒíŠ¸ ì¶”ê°€ (í•™ë²ˆìœ¼ë¡œ ì¡°íšŒ)
   - `studentTimetableParser.ts` íŒŒì„œ êµ¬í˜„ ì™„ë£Œ
   - `storage.saveStudentTimetables()` ì €ì¥ ë¡œì§ êµ¬í˜„ ì™„ë£Œ
   - `storage.getStudentTimetableByStudentCode()` ì¡°íšŒ ë¡œì§ êµ¬í˜„ ì™„ë£Œ
   - `student_timetables` í…Œì´ë¸” ìƒì„± ì™„ë£Œ

2. **ì‹œí—˜ êµ¬ê°„(`segment`) í•„ë“œ ë„ì…**
   - `ClassSession` íƒ€ì…ì— `segment` í•„ë“œ ì¶”ê°€
   - `class_sessions` í…Œì´ë¸”ì— `segment` ì»¬ëŸ¼ ì¶”ê°€
   - `scheduleMatcher.ts`ì—ì„œ ì„¸ì…˜ ìƒì„± ì‹œ `segment` ìë™ ì„¤ì •

3. **LessonPlanTemplateEditor íƒ­ ê¸°ëŠ¥**
   - ì—¬ëŸ¬ ì‹œí—˜ êµ¬ê°„ì„ íƒ­ìœ¼ë¡œ ê´€ë¦¬
   - ê° êµ¬ê°„ë³„ ë…ë¦½ì ì¸ í…œí”Œë¦¿ í¸ì§‘ ë° ì €ì¥

4. **Domain Layer ì„¸ê·¸ë¨¼íŠ¸ ì²˜ë¦¬**
   - `isSessionInSegment()` í•¨ìˆ˜ê°€ `segment` í•„ë“œ ìš°ì„  ì‚¬ìš©
   - ê¸°ì¡´ í”Œë˜ê·¸ ê¸°ë°˜ ë¡œì§ê³¼ì˜ í•˜ìœ„ í˜¸í™˜ì„± ìœ ì§€

5. **Storage ë ˆì´ì–´ í™•ì¥**
   - `segment` í•„ë“œ ì €ì¥/ì¡°íšŒ ì§€ì›
   - `getClassSessions()`ì— `subject` íŒŒë¼ë¯¸í„° ì¶”ê°€
   - DB ì»¬ëŸ¼ê³¼ ë„ë©”ì¸ íƒ€ì… ê°„ ë§¤í•‘ ì²˜ë¦¬
   - í•™ìƒ ì‹œê°„í‘œ ì €ì¥/ì¡°íšŒ ê¸°ëŠ¥ ì¶”ê°€

6. **UI ê°œì„ : í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜**
   - `SchoolSelection`: ArrowDown/ArrowUp/Enter í‚¤ ì§€ì›
   - `TeacherScheduleUpload`: êµì‚¬ ê²€ìƒ‰ ì‹œ í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜ ì§€ì›
   - ê²€ìƒ‰ ì¤‘ ìƒíƒœ ê´€ë¦¬ë¡œ ì‚¬ìš©ì ê²½í—˜ ê°œì„ 

7. **TeacherScheduleUpload ìë™ ë¡œë“œ ê¸°ëŠ¥**
   - DBì—ì„œ ìˆ˜ì—… ì¼ì • ìë™ ë¡œë“œ (`loadSessionsFromDB`)
   - `viewMode`ê°€ `'plan'`ì¼ ë•Œ ìë™ìœ¼ë¡œ ì„¸ì…˜ ë¡œë“œ
   - DBì— ì—†ìœ¼ë©´ ê¸°ì¡´ ë°©ì‹ëŒ€ë¡œ ìƒì„± (fallback)

8. **ê³¼ëª© ì„ íƒ ê¸°ëŠ¥ ì¶”ê°€**
   - `TeacherScheduleUpload`ì— ê³¼ëª© ì„ íƒ ë“œë¡­ë‹¤ìš´ ì¶”ê°€
   - ê³¼ëª©ë³„ë¡œ ìˆ˜ì—… ì¼ì • ê´€ë¦¬ ê°€ëŠ¥

9. **ClassSessionTable ê°œì„ **
   - ì „ì²´ ì €ì¥ ë²„íŠ¼ ì¶”ê°€ (`onSaveAll` ì½œë°±)

10. **ì—¬ëŸ¬ íŒŒì¼ ì—…ë¡œë“œ ì§€ì›**
    - `StudentTimetableUpload`ì—ì„œ ì—¬ëŸ¬ íŒŒì¼ ë™ì‹œ ì—…ë¡œë“œ ê°€ëŠ¥
    - ê° íŒŒì¼ë³„ë¡œ íŒŒì‹± í›„ ê²°ê³¼ ë³‘í•©

ë¬¸ì„œë¥¼ í˜„ì¬ ì½”ë“œë² ì´ìŠ¤ ìƒíƒœì— ë§ê²Œ ì—…ë°ì´íŠ¸í–ˆìŠµë‹ˆë‹¤.
```

ì£¼ìš” ì—…ë°ì´íŠ¸ ë‚´ìš©:

1. **í•™ìƒ ì‹œê°„í‘œ ê¸°ëŠ¥ êµ¬í˜„ ì™„ë£Œ**: íŒŒì„œ, ì €ì¥ ë¡œì§, ì¡°íšŒ ê¸°ëŠ¥ ëª¨ë‘ êµ¬í˜„ ì™„ë£Œ
2. **`StudentTimetableViewer` ì»´í¬ë„ŒíŠ¸ ì¶”ê°€**: í•™ë²ˆìœ¼ë¡œ í•™ìƒ ì‹œê°„í‘œ ì¡°íšŒ ê¸°ëŠ¥
3. **ì—¬ëŸ¬ íŒŒì¼ ì—…ë¡œë“œ ì§€ì›**: `StudentTimetableUpload`ì—ì„œ ì—¬ëŸ¬ íŒŒì¼ ë™ì‹œ ì—…ë¡œë“œ ê°€ëŠ¥
4. **`student_timetables` í…Œì´ë¸”**: ì˜ˆì •ì—ì„œ êµ¬í˜„ ì™„ë£Œë¡œ ë³€ê²½
5. **Storage ê¸°ëŠ¥ í™•ì¥**: í•™ìƒ ì‹œê°„í‘œ ì €ì¥/ì¡°íšŒ í•¨ìˆ˜ ì¶”ê°€
6. **ë°ì´í„° íë¦„ ì—…ë°ì´íŠ¸**: í•™ìƒ ì‹œê°„í‘œ ì—…ë¡œë“œ ë° ì¡°íšŒ ë‹¨ê³„ ì¶”ê°€

ë¬¸ì„œê°€ í˜„ì¬ ì½”ë“œë² ì´ìŠ¤ ìƒíƒœë¥¼ ë°˜ì˜í•©ë‹ˆë‹¤.